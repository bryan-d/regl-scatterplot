!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("pub-sub-es"),require("regl")):"function"==typeof define&&define.amd?define(["exports","pub-sub-es","regl"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self).createScatterplot={},n.createPubSub,n.createREGL)}(this,(function(n,e,t){"use strict";function o(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var r=o(e),i=o(t);function a(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function c(n,e,t){return(e=function(n){var e=function(n,e){if("object"!=typeof n||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,r,i,a,c=[],l=!0,s=!1;try{if(i=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;l=!1}else for(;!(l=(o=i.call(t)).done)&&(c.push(o.value),c.length!==e);l=!0);}catch(n){s=!0,r=n}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(s)throw r}}return c}}(n,e)||u(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(n){return function(n){if(Array.isArray(n))return d(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||u(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(n,e){if(n){if("string"==typeof n)return d(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(n,e):void 0}}function d(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}var f,p="undefined"!=typeof Float32Array?Float32Array:Array;function v(){var n=new p(16);return p!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function m(n){var e=new p(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function h(n,e){var t=e[0],o=e[1],r=e[2],i=e[3],a=e[4],c=e[5],l=e[6],s=e[7],u=e[8],d=e[9],f=e[10],p=e[11],v=e[12],m=e[13],h=e[14],y=e[15],g=t*c-o*a,w=t*l-r*a,x=t*s-i*a,b=o*l-r*c,S=o*s-i*c,E=r*s-i*l,M=u*m-d*v,P=u*h-f*v,C=u*y-p*v,A=d*h-f*m,I=d*y-p*m,R=f*y-p*h,T=g*R-w*I+x*A+b*C-S*P+E*M;return T?(T=1/T,n[0]=(c*R-l*I+s*A)*T,n[1]=(r*I-o*R-i*A)*T,n[2]=(m*E-h*S+y*b)*T,n[3]=(f*S-d*E-p*b)*T,n[4]=(l*C-a*R-s*P)*T,n[5]=(t*R-r*C+i*P)*T,n[6]=(h*x-v*E-y*w)*T,n[7]=(u*E-f*x+p*w)*T,n[8]=(a*I-c*C+s*M)*T,n[9]=(o*C-t*I-i*M)*T,n[10]=(v*S-m*x+y*g)*T,n[11]=(d*x-u*S-p*g)*T,n[12]=(c*P-a*A-l*M)*T,n[13]=(t*A-o*P+r*M)*T,n[14]=(m*w-v*b-h*g)*T,n[15]=(u*b-d*w+f*g)*T,n):null}function y(n,e,t){var o=e[0],r=e[1],i=e[2],a=e[3],c=e[4],l=e[5],s=e[6],u=e[7],d=e[8],f=e[9],p=e[10],v=e[11],m=e[12],h=e[13],y=e[14],g=e[15],w=t[0],x=t[1],b=t[2],S=t[3];return n[0]=w*o+x*c+b*d+S*m,n[1]=w*r+x*l+b*f+S*h,n[2]=w*i+x*s+b*p+S*y,n[3]=w*a+x*u+b*v+S*g,w=t[4],x=t[5],b=t[6],S=t[7],n[4]=w*o+x*c+b*d+S*m,n[5]=w*r+x*l+b*f+S*h,n[6]=w*i+x*s+b*p+S*y,n[7]=w*a+x*u+b*v+S*g,w=t[8],x=t[9],b=t[10],S=t[11],n[8]=w*o+x*c+b*d+S*m,n[9]=w*r+x*l+b*f+S*h,n[10]=w*i+x*s+b*p+S*y,n[11]=w*a+x*u+b*v+S*g,w=t[12],x=t[13],b=t[14],S=t[15],n[12]=w*o+x*c+b*d+S*m,n[13]=w*r+x*l+b*f+S*h,n[14]=w*i+x*s+b*p+S*y,n[15]=w*a+x*u+b*v+S*g,n}function g(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function w(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function x(n,e,t){var o=e[0],r=e[1],i=e[2],a=e[3];return n[0]=t[0]*o+t[4]*r+t[8]*i+t[12]*a,n[1]=t[1]*o+t[5]*r+t[9]*i+t[13]*a,n[2]=t[2]*o+t[6]*r+t[10]*i+t[14]*a,n[3]=t[3]*o+t[7]*r+t[11]*i+t[15]*a,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)}),f=new p(4),p!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0,f[3]=0),function(){var n=function(){var n=new p(2);return p!=Float32Array&&(n[0]=0,n[1]=0),n}()}();const b=(n=[0,0],e=1,t=0,o=[0,0],r=[[0,1/0],[0,1/0]],i=[[-1/0,1/0],[-1/0,1/0]])=>{const a=new Float32Array(16),c=new Float32Array(16),l=new Float32Array(16);let s=v(),u=[...o.slice(0,2),0,1];const d=Array.isArray(r[0])?[...r[0]]:[...r],f=Array.isArray(r[0])?[...r[1]]:[...r],p=Array.isArray(i[0])?[...i[0]]:[...i],m=Array.isArray(i[0])?[...i[1]]:[...i],b=()=>function(n,e){var t=e[0],o=e[1],r=e[2],i=e[4],a=e[5],c=e[6],l=e[8],s=e[9],u=e[10];return n[0]=Math.hypot(t,o,r),n[1]=Math.hypot(i,a,c),n[2]=Math.hypot(l,s,u),n}(a,s).slice(0,2),S=()=>{const n=b();return Math.min(n[0],n[1])},E=()=>{const n=b();return Math.max(n[0],n[1])},M=([n=0,e=0]=[],t=1,o=0)=>{s=v(),P([-n,-e]),A(o),C(1/t)},P=([n=0,e=0]=[])=>{a[0]=n,a[1]=e,a[2]=0;const t=g(c,a);y(s,t,s)},C=(n,e)=>{const t=Array.isArray(n);let o=t?n[0]:n,r=t?n[1]:n;if(o<=0||r<=0||1===o&&1===r)return;const i=b(),p=i[0]*o,v=i[1]*r;if(o=Math.max(d[0],Math.min(p,d[1]))/i[0],r=Math.max(f[0],Math.min(v,f[1]))/i[1],1===o&&1===r)return;a[0]=o,a[1]=r,a[2]=1;const m=w(c,a),x=e?[...e,0]:u,S=g(a,x);y(s,S,y(s,m,y(s,h(l,S),s)))},A=n=>{const e=v();!function(n,e,t){var o,r,i,a=t[0],c=t[1],l=t[2],s=Math.hypot(a,c,l);s<1e-6||(a*=s=1/s,c*=s,l*=s,o=Math.sin(e),i=1-(r=Math.cos(e)),n[0]=a*a*i+r,n[1]=c*a*i+l*o,n[2]=l*a*i-c*o,n[3]=0,n[4]=a*c*i-l*o,n[5]=c*c*i+r,n[6]=l*c*i+a*o,n[7]=0,n[8]=a*l*i+c*o,n[9]=c*l*i-a*o,n[10]=l*l*i+r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1)}(e,n,[0,0,1]),y(s,e,s)},I=n=>{!n||n.length<16||(s=n)};return M(n,e,t),{get translation(){return function(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}(a,s).slice(0,2)},get target(){return x(a,u,h(l,s)).slice(0,2)},get scaling(){return b()},get minScaling(){return S()},get maxScaling(){return E()},get scaleBounds(){return[[...d],[...f]]},get translationBounds(){return[[...p],[...m]]},get distance(){return(()=>{const n=b();return[1/n[0],1/n[1]]})()},get minDistance(){return 1/S()},get maxDistance(){return 1/E()},get rotation(){return Math.acos(s[0]/E())},get view(){return s},get viewCenter(){return u.slice(0,2)},lookAt:M,translate:P,pan:P,rotate:A,scale:C,zoom:C,reset:()=>{M(n,e,t)},set:(...n)=>(console.warn("`set()` is deprecated. Please use `setView()` instead."),I(...n)),setScaleBounds:n=>{const e=Array.isArray(n[0]);d[0]=e?n[0][0]:n[0],d[1]=e?n[0][1]:n[1],f[0]=e?n[1][0]:n[0],f[1]=e?n[1][1]:n[1]},setTranslationBounds:n=>{const e=Array.isArray(n[0]);p[0]=e?n[0][0]:n[0],p[1]=e?n[0][1]:n[1],m[0]=e?n[1][0]:n[0],m[1]=e?n[1][1]:n[1]},setView:I,setViewCenter:n=>{u=[...n.slice(0,2),0,1]}}},S=["pan","rotate"],E={alt:"altKey",cmd:"metaKey",ctrl:"ctrlKey",meta:"metaKey",shift:"shiftKey"},M=(n,{distance:e=1,target:t=[0,0],rotation:o=0,isNdc:r=!0,isFixed:i=!1,isPan:a=!0,isPanInverted:c=[!1,!0],panSpeed:l=1,isRotate:s=!0,rotateSpeed:u=1,defaultMouseDownMoveAction:d="pan",mouseDownMoveModKey:f="alt",isZoom:p=!0,zoomSpeed:v=1,viewCenter:m,scaleBounds:h,translationBounds:y,onKeyDown:g=(()=>{}),onKeyUp:w=(()=>{}),onMouseDown:x=(()=>{}),onMouseUp:M=(()=>{}),onMouseMove:P=(()=>{}),onWheel:C=(()=>{})}={})=>{let A=b(t,e,o,m,h,y),I=0,R=0,T=0,O=0,D=0,L=0,B=!1,z=0,j=1,k=1,F=1,N=!1,_=!1,V=!1,W="pan"===d,Z=a,q=a,G=c,H=c,K=p,X=p;const Y=()=>{Z=Array.isArray(a)?Boolean(a[0]):a,q=Array.isArray(a)?Boolean(a[1]):a,G=Array.isArray(c)?Boolean(c[0]):c,H=Array.isArray(c)?Boolean(c[1]):c,K=Array.isArray(p)?Boolean(p[0]):p,X=Array.isArray(p)?Boolean(p[1]):p};Y();const U=r?n=>n/j*2*F:n=>n,$=r?n=>n/k*2:n=>-n,J=r?n=>(n/j*2-1)*F:n=>n,Q=r?n=>1-n/k*2:n=>n,nn=()=>{const e=n.getBoundingClientRect();j=e.width,k=e.height,F=j/k},en=n=>{V=!1,w(n)},tn=n=>{V=n[E[f]],g(n)},on=n=>{B=!1,M(n)},rn=n=>{B=1===n.buttons,x(n)},an=void 0!==document.createEvent("MouseEvent").offsetX?n=>{T=n.offsetX,O=n.offsetY}:e=>{const t=n.getBoundingClientRect();T=e.clientX-t.left,O=e.clientY-t.top},cn=n=>{I=n.clientX,R=n.clientY},ln=n=>{cn(n),P(n)},sn=n=>{if(K||X){n.preventDefault(),cn(n),an(n);const e=1===n.deltaMode?12:1;z+=e*(n.deltaY||n.deltaX||0)}C(n)};window.addEventListener("keydown",tn,{passive:!0}),window.addEventListener("keyup",en,{passive:!0}),n.addEventListener("mousedown",rn,{passive:!0}),window.addEventListener("mouseup",on,{passive:!0}),window.addEventListener("mousemove",ln,{passive:!0}),n.addEventListener("wheel",sn,{passive:!1}),A.config=({defaultMouseDownMoveAction:n=null,isFixed:e=null,isPan:t=null,isPanInverted:o=null,isRotate:r=null,isZoom:m=null,panSpeed:h=null,rotateSpeed:y=null,zoomSpeed:g=null,mouseDownMoveModKey:w=null}={})=>{d=null!==n&&S.includes(n)?n:d,W="pan"===d,i=null!==e?e:i,a=null!==t?t:a,c=null!==o?o:c,s=null!==r?r:s,p=null!==m?m:p,l=+h>0?h:l,u=+y>0?y:u,v=+g>0?g:v,Y(),f=null!==w&&Object.keys(E).includes(w)?w:f},A.dispose=()=>{A=void 0,window.removeEventListener("keydown",tn),window.removeEventListener("keyup",en),n.removeEventListener("mousedown",rn),window.removeEventListener("mouseup",on),window.removeEventListener("mousemove",ln),n.removeEventListener("wheel",sn)},A.refresh=nn,A.tick=()=>{if(i){const n=_;return _=!1,n}N=!1;const n=I,e=R;if((Z||q)&&B&&(W&&!V||!W&&V)){const t=Z?U(l*(G?D-n:n-D)):0,o=q?$(l*(H?L-e:e-L)):0;0===t&&0===o||(A.pan([t,o]),N=!0)}if((K||X)&&z){const n=v*Math.exp(z/k),e=J(T),t=Q(O);A.scale([K?1/n:1,X?1/n:1],[e,t]),N=!0}if(s&&B&&(W&&V||!W&&!V)&&Math.abs(D-n)+Math.abs(L-e)>0){const t=j/2,o=k/2,r=D-t,i=o-L,a=n-t,c=o-e,l=function(n,e){var t=n[0],o=n[1],r=e[0],i=e[1],a=Math.sqrt(t*t+o*o)*Math.sqrt(r*r+i*i),c=a&&(t*r+o*i)/a;return Math.acos(Math.min(Math.max(c,-1),1))}([r,i],[a,c]),s=r*c-a*i;A.rotate(u*l*Math.sign(s)),N=!0}z=0,D=n,L=e;const t=N||_;return _=!1,t};const un=n=>function(){n.apply(null,arguments),_=!0};return A.lookAt=un(A.lookAt),A.translate=un(A.translate),A.pan=un(A.pan),A.rotate=un(A.rotate),A.scale=un(A.scale),A.zoom=un(A.zoom),A.reset=un(A.reset),A.set=un(A.set),A.setScaleBounds=un(A.setScaleBounds),A.setTranslationBounds=un(A.setTranslationBounds),A.setView=un(A.setView),A.setViewCenter=un(A.setViewCenter),nn(),A};function P(n,e,t,o,r,i){if(r-o<=t)return;const a=o+r>>1;C(n,e,a,o,r,i%2),P(n,e,t,o,a-1,i+1),P(n,e,t,a+1,r,i+1)}function C(n,e,t,o,r,i){for(;r>o;){if(r-o>600){const a=r-o+1,c=t-o+1,l=Math.log(a),s=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*s*(a-s)/a)*(c-a/2<0?-1:1);C(n,e,t,Math.max(o,Math.floor(t-c*s/a+u)),Math.min(r,Math.floor(t+(a-c)*s/a+u)),i)}const a=e[2*t+i];let c=o,l=r;for(A(n,e,o,t),e[2*r+i]>a&&A(n,e,o,r);c<l;){for(A(n,e,c,l),c++,l--;e[2*c+i]<a;)c++;for(;e[2*l+i]>a;)l--}e[2*o+i]===a?A(n,e,o,l):(l++,A(n,e,l,r)),l<=t&&(o=l+1),t<=l&&(r=l-1)}}function A(n,e,t,o){I(n,t,o),I(e,2*t,2*o),I(e,2*t+1,2*o+1)}function I(n,e,t){const o=n[e];n[e]=n[t],n[t]=o}function R(n,e,t,o){const r=n-t,i=e-o;return r*r+i*i}const T=n=>n[0],O=n=>n[1];class D{constructor(n,e=T,t=O,o=64,r=Float64Array){this.nodeSize=o,this.points=n;const i=n.length<65536?Uint16Array:Uint32Array,a=this.ids=new i(n.length),c=this.coords=new r(2*n.length);for(let o=0;o<n.length;o++)a[o]=o,c[2*o]=e(n[o]),c[2*o+1]=t(n[o]);P(a,c,o,0,a.length-1,0)}range(n,e,t,o){return function(n,e,t,o,r,i,a){const c=[0,n.length-1,0],l=[];let s,u;for(;c.length;){const d=c.pop(),f=c.pop(),p=c.pop();if(f-p<=a){for(let a=p;a<=f;a++)s=e[2*a],u=e[2*a+1],s>=t&&s<=r&&u>=o&&u<=i&&l.push(n[a]);continue}const v=Math.floor((p+f)/2);s=e[2*v],u=e[2*v+1],s>=t&&s<=r&&u>=o&&u<=i&&l.push(n[v]);const m=(d+1)%2;(0===d?t<=s:o<=u)&&(c.push(p),c.push(v-1),c.push(m)),(0===d?r>=s:i>=u)&&(c.push(v+1),c.push(f),c.push(m))}return l}(this.ids,this.coords,n,e,t,o,this.nodeSize)}within(n,e,t){return function(n,e,t,o,r,i){const a=[0,n.length-1,0],c=[],l=r*r;for(;a.length;){const s=a.pop(),u=a.pop(),d=a.pop();if(u-d<=i){for(let r=d;r<=u;r++)R(e[2*r],e[2*r+1],t,o)<=l&&c.push(n[r]);continue}const f=Math.floor((d+u)/2),p=e[2*f],v=e[2*f+1];R(p,v,t,o)<=l&&c.push(n[f]);const m=(s+1)%2;(0===s?t-r<=p:o-r<=v)&&(a.push(d),a.push(f-1),a.push(m)),(0===s?t+r>=p:o+r>=v)&&(a.push(f+1),a.push(u),a.push(m))}return c}(this.ids,this.coords,n,e,t,this.nodeSize)}}const{push:L,splice:B}=Array.prototype,z=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),j=Float32Array.BYTES_PER_ELEMENT,k={duplicate(n,e=1,t=1){const o=[],r=new Array(2*e);for(let i=0,a=n.length/e;i<a;i++){const a=i*e;for(let o=0;o<e;o++){const i=n[a+o];r[o]=i,r[o+e]=i*t}L.apply(o,r)}return o},mapElement(n,e,t,o){for(let r=0,i=n.length/t;r<i;r++){const i=e+r*t;n[i]=o(n[i],i,r)}return n},copyElement(n,e,t,o){const r=new Array(o),i=e*o;for(let e=0;e<o;e++)r[e]=n[i+e];return B.call(n,t*o,0,...r),n},increaseStride(n,e,t,o=0){const r=[],i=new Array(t).fill(o);for(let t=0,o=n.length/e;t<o;t++){const o=t*e;for(let t=0;t<e;t++)i[t]=n[o+t];L.apply(r,i)}return r}};var F=(n,{projection:e=z,model:t=z,view:o=z,points:r=[],colorIndices:i=[],color:a=[.8,.5,0,1],opacity:c=null,opacities:l=[],width:s=1,widths:u=[],miter:d=1,is2d:f=!1,zPos2d:p=0}={})=>{if(!n)return void console.error("Regl instance is undefined.");const v=new Float32Array(16);let m,h,g,w,x,b,S,E,M,P,C,A,I,R,T,O,D,L,B=f?2:3;const F=()=>+(l.length===h||null!==c),N=()=>{P=n.buffer(),C=n.buffer(),A=n.buffer(),T=n.buffer(),O={prevPosition:{buffer:()=>P,offset:0,stride:3*j},currPosition:{buffer:()=>P,offset:3*j*2,stride:3*j},nextPosition:{buffer:()=>P,offset:3*j*4,stride:3*j},opacity:{buffer:()=>C,offset:2*j,stride:j},offsetScale:{buffer:()=>A,offset:2*j,stride:j},colorIndex:{buffer:()=>T,offset:2*j,stride:j}},D=n.elements(),L=n({attributes:O,depth:{enable:!f},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},uniforms:{projectionViewModel:(n,e)=>{const t=n.projection||e.projection,o=n.model||e.model,r=n.view||e.view;return y(v,t,y(v,r,o))},aspectRatio:({viewportWidth:n,viewportHeight:e})=>n/e,colorTex:()=>I,colorTexRes:()=>R,colorTexEps:()=>.5/R,pixelRatio:({pixelRatio:n})=>n,width:({pixelRatio:n,viewportHeight:e})=>s/e*n,useOpacity:F,useColorOpacity:()=>+!F(),miter:d},elements:()=>D,vert:"\nuniform mat4 projectionViewModel;\nuniform float aspectRatio;\n\nuniform sampler2D colorTex;\nuniform float colorTexRes;\nuniform float colorTexEps;\nuniform float width;\nuniform float useOpacity;\nuniform float useColorOpacity;\nuniform int miter;\n\nattribute vec3 prevPosition;\nattribute vec3 currPosition;\nattribute vec3 nextPosition;\nattribute float opacity;\nattribute float offsetScale;\nattribute float colorIndex;\n\nvarying vec4 color;\n\nvoid main() {\n  vec2 aspectVec = vec2(aspectRatio, 1.0);\n  vec4 prevProjected = projectionViewModel * vec4(prevPosition, 1.0);\n  vec4 currProjected = projectionViewModel * vec4(currPosition, 1.0);\n  vec4 nextProjected = projectionViewModel * vec4(nextPosition, 1.0);\n\n  // get 2D screen space with W divide and aspect correction\n  vec2 prevScreen = prevProjected.xy / prevProjected.w * aspectVec;\n  vec2 currScreen = currProjected.xy / currProjected.w * aspectVec;\n  vec2 nextScreen = nextProjected.xy / nextProjected.w * aspectVec;\n\n  // starting point uses (next - current)\n  vec2 dir = vec2(0.0);\n  if (currScreen == prevScreen) {\n    dir = normalize(nextScreen - currScreen);\n  }\n  // ending point uses (current - previous)\n  else if (currScreen == nextScreen) {\n    dir = normalize(currScreen - prevScreen);\n  }\n  // somewhere in middle, needs a join\n  else {\n    // get directions from (C - B) and (B - A)\n    vec2 dirA = normalize((currScreen - prevScreen));\n    if (miter == 1) {\n      vec2 dirB = normalize((nextScreen - currScreen));\n      // now compute the miter join normal and length\n      vec2 tangent = normalize(dirA + dirB);\n      vec2 perp = vec2(-dirA.y, dirA.x);\n      vec2 miter = vec2(-tangent.y, tangent.x);\n      dir = tangent;\n    } else {\n      dir = dirA;\n    }\n  }\n\n  vec2 normal = vec2(-dir.y, dir.x) * width;\n  normal.x /= aspectRatio;\n  vec4 offset = vec4(normal * offsetScale, 0.0, 0.0);\n  gl_Position = currProjected + offset;\n\n  // Get color from texture\n  float colorRowIndex = floor((colorIndex + colorTexEps) / colorTexRes);\n  vec2 colorTexIndex = vec2(\n    (colorIndex / colorTexRes) - colorRowIndex + colorTexEps,\n    colorRowIndex / colorTexRes + colorTexEps\n  );\n\n  color = texture2D(colorTex, colorTexIndex);\n  color.a = useColorOpacity * color.a + useOpacity * opacity;\n}",frag:"\nprecision mediump float;\nvarying vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"})},_=()=>{V(),N()},V=()=>{r=null,w=null,x=null,E=null,M=null,P.destroy(),A.destroy(),D.destroy()},W=(n,e)=>{const t=e.flat(2);return t.length===h?t:t.length===m?g.map(((n,e)=>Array(n).fill(t[e]))).flat():n},Z=(n=[],{colorIndices:e=i,opacities:t=l,widths:o=u,is2d:a=f}={})=>{r=n,B=(f=a)?2:3,m=Array.isArray(r[0])?r.length:1,g=m>1?r.map((n=>Math.floor(n.length/B))):[Math.floor(r.length/B)],h=g.reduce(((n,e)=>n+e),0),i=W(i,e),l=W(l,t),u=W(u,o),r&&h>1?(()=>{1===m&&r.length%B>0&&console.warn(`The length of points (${h}) does not match the dimensions (${B}). Incomplete points are ignored.`),w=r.flat().slice(0,h*B),f&&(w=k.increaseStride(w,2,3,p)),i.length!==h&&(i=new Array(h).fill(0)),u.length!==h&&(u=new Array(h).fill(1));let n=i.slice(),e=l.length===h?l.slice():new Array(h).fill(+c),t=u.slice(),o=0;g.forEach((r=>{const i=o+r-1;k.copyElement(w,i,i,3),k.copyElement(w,o,o,3),k.copyElement(n,i,i,1),k.copyElement(n,o,o,1),k.copyElement(e,i,i,1),k.copyElement(e,o,o,1),k.copyElement(t,i,i,1),k.copyElement(t,o,o,1),o+=r+2})),x=new Float32Array(k.duplicate(w,3)),b=k.duplicate(n),S=k.duplicate(e),E=k.duplicate(t,1,-1),M=((n,e=[])=>{let t=0;return n.forEach((n=>{for(let o=0;o<n-1;o++){const n=t+2*o,r=n+1,i=n+2,a=n+3;e.push(n,r,i,i,r,a)}t+=2*(n+2)})),e})(g),P({usage:"dynamic",type:"float",length:x.length*j,data:x}),C({usage:"dynamic",type:"float",length:S.length*j,data:S}),A({usage:"dynamic",type:"float",length:E.length*j,data:E}),T({usage:"dynamic",type:"float",length:b.length*j,data:b}),D({primitive:"triangles",usage:"dynamic",type:M.length>65536?"uint32":"uint16",data:M})})():_()},q=(n,e=-1)=>Array.isArray(n)?n.length&&!Array.isArray(n[0])?e+1:q(n[0],++e):e,G=()=>{const e=0===q(a)?[a]:a;R=Math.max(2,Math.ceil(Math.sqrt(e.length)));const t=new Uint8Array(R**2*4);e.forEach(((n,e)=>{t[4*e]=Math.min(255,Math.max(0,Math.round(255*n[0]))),t[4*e+1]=Math.min(255,Math.max(0,Math.round(255*n[1]))),t[4*e+2]=Math.min(255,Math.max(0,Math.round(255*n[2]))),t[4*e+3]=Number.isNaN(+n[3])?255:Math.min(255,Math.max(0,Math.round(255*n[3])))})),I=n.texture({data:t,shape:[R,R,4]})};return N(),G(),r&&r.length>1&&Z(r),{clear:_,destroy:V,draw:({projection:n,model:i,view:a}={})=>{n&&(e=n),i&&(t=i),a&&(o=a),r&&r.length>1&&L({projection:e,model:t,view:o})},getPoints:()=>r,setPoints:Z,getData:()=>({points:x,widths:E,opacities:S,colorIndices:b}),getBuffer:()=>({points:P,widths:A,opacities:C,colorIndices:T}),getStyle:()=>({color:a,miter:d,width:s}),setStyle:({color:n,opacity:e,miter:t,width:o}={})=>{n&&((n,e=c)=>{a=n,c=e,I&&I.destroy(),G()})(n,e),t&&(d=t),+o>0&&(s=o)}}};const N=n=>n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1,_=n=>n,V=(n,e=(n=>n))=>{const t=[];for(let o=0;o<n;o++)t.push(e(o,n));return t},W=(n,...e)=>(e.forEach((e=>{const t=Object.keys(e).reduce(((n,t)=>(n[t]=Object.getOwnPropertyDescriptor(e,t),n)),{});Object.getOwnPropertySymbols(e).forEach((n=>{const o=Object.getOwnPropertyDescriptor(e,n);o.enumerable&&(t[n]=o)})),Object.defineProperties(n,t)})),n),Z=(n,e)=>t=>W(t,{get[n](){return e}}),q=(n=1)=>new Promise((e=>{let t=0;const o=()=>requestAnimationFrame((()=>{t++,t<n?o():e()}));o()})),G=(n,e,t=null)=>{let o,r=0;t=null===t?e:t;const i=(...e)=>{clearTimeout(o),o=setTimeout((()=>{r>0&&(n(...e),r=0)}),t)};let a=!1;const c=(...t)=>{a?(r++,i(...t)):(n(...t),i(...t),a=!0,r=0,setTimeout((()=>{a=!1}),e))};return c.reset=()=>{a=!1},c.cancel=()=>{clearTimeout(o)},c.now=(...e)=>n(...e),c};var H,K,X="auto",Y=Float32Array.BYTES_PER_ELEMENT,U=["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"],$={color:[0,0,0,0],depth:1},J="panZoom",Q="lasso",nn="rotate",en=[J,Q,nn],tn=J,on={cubicIn:n=>n*n*n,cubicInOut:N,cubicOut:n=>--n*n*n+1,linear:n=>n,quadIn:n=>n*n,quadInOut:n=>n<.5?2*n*n:(4-2*n)*n-1,quadOut:n=>n*(2-n)},rn=N,an="continuous",cn="categorical",ln=[an,cn],sn="deselect",un="lassoEnd",dn=[sn,un],fn=[0,.666666667,1,1],pn=un,vn=750,mn=500,hn=100,yn=250,gn="lasso",wn="rotate",xn="merge",bn=[gn,wn,xn],Sn="alt",En="cmd",Mn="ctrl",Pn="meta",Cn="shift",An=[Sn,En,Mn,Pn,Cn],In=(c(H={},Sn,wn),c(H,Cn,gn),c(H,En,xn),H),Rn=X,Tn=X,On=null,Dn=null,Ln=null,Bn=null,zn=null,jn=[.66,.66,.66,1],kn=[0,.55,1,1],Fn=[1,1,1,1],Nn=[0,0,0,1],_n=null,Vn=[.66,.66,.66,.2],Wn=[0,.55,1,1],Zn=[1,1,1,1],qn=[0,0],Gn=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Hn=[1,1,1,.5],Kn=new Set(["z","valueZ","valueA","value1","category"]),Xn=new Set(["w","valueW","valueB","value2","value"]),Yn=15e3,Un="Points have not been drawn",$n=function(n,e){return!!n&&U.reduce((function(t,o){return n.hasExtension(o)?t:(e||console.warn("WebGL: ".concat(o," extension not supported. Scatterplot might not render properly")),!1)}),!0)},Jn=function(n){var e=n.getContext("webgl",{antialias:!0,preserveDrawingBuffer:!0}),t=[];return U.forEach((function(n){e.getExtension(n)?t.push(n):console.warn("WebGL: ".concat(n," extension not supported. Scatterplot might not render properly"))})),i.default({gl:e,extensions:t})},Qn=function(n,e,t,o){return Math.sqrt(Math.pow(n-t,2)+Math.pow(e-o,2))},ne=function(n,e){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).minLength,o=void 0===t?0:t;return Array.isArray(n)&&n.length>=o&&n.every(e)},ee=function(n){return!Number.isNaN(+n)&&+n>=0},te=function(n){return!Number.isNaN(+n)&&+n>0},oe=function(n,e){return function(t){return n.indexOf(t)>=0?t:e}},re=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yn;return new Promise((function(o,r){(function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yn;return new Promise((function(o,r){var i=new Image;e&&(i.crossOrigin="anonymous"),i.src=n,i.onload=function(){o(i)};var a=function(){r(new Error("IMAGE_LOAD_ERROR"))};i.onerror=a,setTimeout(a,t)}))})(e,0!==e.indexOf(window.location.origin)&&-1===e.indexOf("base64"),t).then((function(e){o(n.texture(e))})).catch((function(n){r(n)}))}))},ie=function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[].concat(s(function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(n,e,t,o){return"#".concat(e).concat(e).concat(t).concat(t).concat(o).concat(o)})).substring(1).match(/.{2}/g).map((function(n){return parseInt(n,16)/Math.pow(255,e)}))}(n,e)),[Math.pow(255,!e)])},ae=function(n){return n>=0&&n<=1},ce=function(n){return Array.isArray(n)&&n.every(ae)},le=function(n){return"string"==typeof n||n instanceof String},se=function(n){return Number.isInteger(n)&&n>=0&&n<=255},ue=function(n){return Array.isArray(n)&&n.every(se)},de=function(n){return Array.isArray(n)&&n.length&&(Array.isArray(n[0])||le(n[0]))},fe=function(n,e){return n>e?n:e},pe=function(n,e){return n<e?n:e},ve=function(n,e){if(4===(o=n).length&&(ce(o)||ue(o))){var t=ce(n);return e&&t||!e&&!t?n:e&&!t?n.map((function(n){return n/255})):n.map((function(n){return 255*n}))}var o,r;if(3===(r=n).length&&(ce(r)||ue(r))){var i=Math.pow(255,!e),a=ce(n);return[].concat(e&&a||!e&&!a?s(n):s(e&&!a?n.map((function(n){return n/255})):n.map((function(n){return 255*n}))),[i])}return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)?ie(n,e):(console.warn("Only HEX, RGB, and RGBA are handled by this function. Returning white instead."),e?[1,1,1,1]:[255,255,255,255])},me=function(n){return Object.entries(n).reduce((function(n,e){var t=l(e,2),o=t[0],r=t[1];return n[r]?n[r]=[].concat(s(n[r]),[o]):n[r]=o,n}),{})},he=function(n){return.21*n[0]+.72*n[1]+.07*n[2]},ye=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.regl,t=n.canvas,o=void 0===t?document.createElement("canvas"):t,r=n.gamma,i=void 0===r?1:r;e||(e=Jn(o));var a=$n(e),c=[o.width,o.height],l=e.framebuffer({width:c[0],height:c[1],colorFormat:"rgba",colorType:"float"}),s=e({vert:"\n      precision highp float;\n      attribute vec2 xy;\n      void main () {\n        gl_Position = vec4(xy, 0, 1);\n      }",frag:"\n      precision highp float;\n      uniform vec2 srcRes;\n      uniform sampler2D src;\n      uniform float gamma;\n\n      vec3 approxLinearToSRGB (vec3 rgb, float gamma) {\n        return pow(clamp(rgb, vec3(0), vec3(1)), vec3(1.0 / gamma));\n      }\n\n      void main () {\n        vec4 color = texture2D(src, gl_FragCoord.xy / srcRes);\n        gl_FragColor = vec4(approxLinearToSRGB(color.rgb, gamma), color.a);\n      }",attributes:{xy:[-4,-4,4,-4,0,4]},uniforms:{src:function(){return l},srcRes:function(){return c},gamma:function(){return i}},count:3,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}}),u=new Set,d=e.frame((function(){for(var n=u.values(),e=n.next();!e.done;)e.value(),e=n.next()})),f=function(){o.width=window.innerWidth*window.devicePixelRatio,o.height=window.innerHeight*window.devicePixelRatio,c[0]=o.width,c[1]=o.height,l.resize.apply(l,c)};n.canvas||(window.addEventListener("resize",f),window.addEventListener("orientationchange",f),f());return{get canvas(){return o},get regl(){return e},get gamma(){return i},set gamma(n){i=+n},get isSupported(){return a},render:function(n,t){e.clear($),l.use((function(){e.clear($),n()})),s(),function(n){var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.drawImage(o,(o.width-n.width)/2,(o.height-n.height)/2,n.width,n.height,0,0,n.width,n.height)}(t)},onFrame:function(n){return u.add(n),function(){u.delete(n)}},refresh:function(){e.poll()},destroy:function(){d.cancel(),o=void 0,e=void 0,window.removeEventListener("resize",f),window.removeEventListener("orientationchange",f)}}},ge=function(n,e){return"".concat(n,"ms ease-out effectIn ").concat(e,"ms 1 normal forwards")},we=function(n,e){return"".concat(n,"ms linear leftSpinIn ").concat(e,"ms 1 normal forwards")},xe=function(n,e){return"".concat(n,"ms linear rightSpinIn ").concat(e,"ms 1 normal forwards")},be=function(n,e){return"".concat(n,"ms linear circleIn ").concat(e,"ms 1 normal forwards")},Se=function(n,e,t){return"\n  @keyframes mainIn {\n    0% {\n      color: ".concat(e,";\n      opacity: 0;\n    }\n    0%, ").concat(n,"% {\n      color: ").concat(e,";\n      opacity: 1;\n    }\n    100% {\n      color: ").concat(t,";\n      opacity: 0.8;\n    }\n  }\n")},Ee=function(n,e,t,o){return"\n  @keyframes effectIn {\n    0%, ".concat(n,"% {\n      opacity: ").concat(t,";\n      transform: scale(").concat(o,");\n    }\n    ").concat(e,"% {\n      opacity: 0.66;\n      transform: scale(1.5);\n    }\n    99% {\n      opacity: 0;\n      transform: scale(2);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0);\n    }\n  }\n")},Me=function(n,e){return"\n  @keyframes leftSpinIn {\n    0% {\n      transform: rotate(".concat(e,"deg);\n    }\n    ").concat(n,"%, 100% {\n      transform: rotate(360deg);\n    }\n  }\n")},Pe=function(n,e){return"\n  @keyframes rightSpinIn {\n    0% {\n      transform: rotate(".concat(e,"deg);\n    }\n    ").concat(n,"%, 100% {\n      transform: rotate(180deg);\n    }\n  }\n")},Ce=function(n){return"".concat(n,"ms linear effectOut 0s 1 normal forwards")},Ae=function(n){return"".concat(n,"ms linear leftSpinOut 0s 1 normal forwards")},Ie=function(n){return"".concat(n,"ms linear rightSpinOut 0s 1 normal forwards")},Re=function(n){return"".concat(n,"ms linear circleOut 0s 1 normal forwards")},Te=function(n,e){return"\n  @keyframes mainOut {\n    0% {\n      color: ".concat(n,";\n    }\n    100% {\n      color: ").concat(e,";\n    }\n  }\n")},Oe=function(n,e){return"\n  @keyframes rightSpinOut {\n    0%, ".concat(n,"% {\n      transform: rotate(").concat(e,"deg);\n    }\n    100% {\n      transform: rotate(0deg);\n    }\n")},De=function(n){return"\n  @keyframes leftSpinOut {\n    0% {\n      transform: rotate(".concat(n,"deg);\n    }\n    100% {\n      transform: rotate(0deg);\n    }\n  }\n")},Le=function(n,e,t){return"\n  @keyframes circleOut {\n    0%, ".concat(n,"% {\n      clip-path: ").concat(e,";\n      opacity: ").concat(t,";\n    }\n    ").concat(n+.01,"% {\n      clip-path: inset(0 0 0 50%);\n      opacity: ").concat(t,";\n    }\n    100% {\n      clip-path: inset(0 0 0 50%);\n      opacity: 0;\n    }\n  }\n")},Be=function(n){return null===n?arguments.length>1&&void 0!==arguments[1]?arguments[1]:null:n},ze=function(){if(!K){var n=document.createElement("style");document.head.appendChild(n),K=n.sheet}return K},je=function(n){var e=ze(),t=e.rules.length;return e.insertRule(n,t),t},ke=function(n){ze().deleteRule(n)},Fe="".concat(2500,"ms ease scaleInFadeOut 0s 1 normal backwards"),Ne=null,_e="".concat(250,"ms ease fadeScaleOut 0s 1 normal backwards"),Ve=null,We=function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.onDraw,r=void 0===o?_:o,i=t.onStart,a=void 0===i?_:i,c=t.onEnd,l=void 0===c?_:c,u=t.enableInitiator,d=void 0===u||u,f=t.initiatorParentElement,p=void 0===f?document.body:f,v=t.longPressIndicatorParentElement,m=void 0===v?document.body:v;t.minDelay,t.minDist;var h=t.pointNorm,y=d,g=p,w=m,x=r,b=a,S=l,E=void 0===h?_:h,M=document.createElement("div"),P=Math.random().toString(36).substring(2,5)+Math.random().toString(36).substring(2,5);M.id="lasso-initiator-".concat(P),M.style.position="fixed",M.style.display="flex",M.style.justifyContent="center",M.style.alignItems="center",M.style.zIndex=99,M.style.width="4rem",M.style.height="4rem",M.style.borderRadius="4rem",M.style.opacity=.5,M.style.transform="translate(-50%,-50%) scale(0) rotate(0deg)";var C,A=function(){var n=document.createElement("div"),e=Math.random().toString(36).substring(2,5)+Math.random().toString(36).substring(2,5);n.id="lasso-long-press-".concat(e),n.style.position="fixed",n.style.width="1.25rem",n.style.height="1.25rem",n.style.pointerEvents="none",n.style.transform="translate(-50%,-50%)";var t=document.createElement("div");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="1.25rem",t.style.height="1.25rem",t.style.clipPath="inset(0px 0px 0px 50%)",t.style.opacity=0,n.appendChild(t);var o=document.createElement("div");o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.width="0.8rem",o.style.height="0.8rem",o.style.border="0.2rem solid currentcolor",o.style.borderRadius="0.8rem",o.style.clipPath="inset(0px 50% 0px 0px)",o.style.transform="rotate(0deg)",t.appendChild(o);var r=document.createElement("div");r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.width="0.8rem",r.style.height="0.8rem",r.style.border="0.2rem solid currentcolor",r.style.borderRadius="0.8rem",r.style.clipPath="inset(0px 50% 0px 0px)",r.style.transform="rotate(0deg)",t.appendChild(r);var i=document.createElement("div");return i.style.position="absolute",i.style.top=0,i.style.left=0,i.style.width="1.25rem",i.style.height="1.25rem",i.style.borderRadius="1.25rem",i.style.background="currentcolor",i.style.transform="scale(0)",i.style.opacity=0,n.appendChild(i),{longPress:n,longPressCircle:t,longPressCircleLeft:o,longPressCircleRight:r,longPressEffect:i}}(),I=A.longPress,R=A.longPressCircle,T=A.longPressCircleLeft,O=A.longPressCircleRight,D=A.longPressEffect,L=!1,B=!1,z=[],j=[],k=!1,F=null,N=null,V=null,H=null,K=null,X=null,Y=null,U=null,$=null,J=null,Q=function(){L=!1};window.addEventListener("mouseup",Q);var nn,en=function(){M.style.opacity=.5,M.style.transform="translate(-50%,-50%) scale(0) rotate(0deg)"},tn=function(n,e){var t=getComputedStyle(n),o=+t.opacity,r=t.transform.match(/([0-9.-]+)+/g),i=+r[0],a=+r[1],c=Math.sqrt(i*i+a*a),l=Math.atan2(a,i)*(180/Math.PI);return{opacity:o,scale:c,rotate:l=e&&l<=0?360+l:l}},on=function(n){if(y&&!L){var e=n.clientX,t=n.clientY;M.style.top="".concat(t,"px"),M.style.left="".concat(e,"px");var o=tn(M),r=o.opacity,i=o.scale,a=o.rotate;M.style.opacity=r,M.style.transform="translate(-50%,-50%) scale(".concat(i,") rotate(").concat(a,"deg)"),M.style.animation="none",q().then((function(){null!==Ne&&ke(Ne),Ne=je(function(n,e,t){return"\n@keyframes scaleInFadeOut {\n  0% {\n    opacity: ".concat(n,";\n    transform: translate(-50%,-50%) scale(").concat(e,") rotate(").concat(t,"deg);\n  }\n  10% {\n    opacity: 1;\n    transform: translate(-50%,-50%) scale(1) rotate(").concat(t+20,"deg);\n  }\n  100% {\n    opacity: 0;\n    transform: translate(-50%,-50%) scale(0.9) rotate(").concat(t+60,"deg);\n  }\n}\n")}(r,i,a)),M.style.animation=Fe,q().then((function(){en()}))}))}},rn=function(){var n=tn(M),e=n.opacity,t=n.scale,o=n.rotate;M.style.opacity=e,M.style.transform="translate(-50%,-50%) scale(".concat(t,") rotate(").concat(o,"deg)"),M.style.animation="none",q(2).then((function(){null!==Ve&&ke(Ve),Ve=je(function(n,e,t){return"\n@keyframes fadeScaleOut {\n  0% {\n    opacity: ".concat(n,";\n    transform: translate(-50%,-50%) scale(").concat(e,") rotate(").concat(t,"deg);\n  }\n  100% {\n    opacity: 0;\n    transform: translate(-50%,-50%) scale(0) rotate(").concat(t,"deg);\n  }\n}\n")}(e,t,o)),M.style.animation=_e,q().then((function(){en()}))}))},an=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{time:vn,extraTime:mn,delay:hn},o=t.time,r=void 0===o?vn:o,i=t.extraTime,a=void 0===i?mn:i,c=t.delay,l=void 0===c?hn:c;k=!0;var s=getComputedStyle(I);I.style.color=s.color,I.style.top="".concat(e,"px"),I.style.left="".concat(n,"px"),I.style.animation="none";var u=getComputedStyle(R);R.style.clipPath=u.clipPath,R.style.opacity=u.opacity,R.style.animation="none";var d=tn(D);D.style.opacity=d.opacity,D.style.transform="scale(".concat(d.scale,")"),D.style.animation="none";var f=tn(T);T.style.transform="rotate(".concat(f.rotate,"deg)"),T.style.animation="none";var p=tn(O);O.style.transform="rotate(".concat(p.rotate,"deg)"),O.style.animation="none",q().then((function(){if(k){null!==K&&ke(K),null!==H&&ke(H),null!==V&&ke(V),null!==N&&ke(N),null!==F&&ke(F);var n=function(n){var e,t,o,r,i,a=n.time,c=void 0===a?vn:a,l=n.extraTime,s=void 0===l?mn:l,u=n.delay,d=void 0===u?hn:u,f=n.currentColor,p=n.targetColor,v=n.effectOpacity,m=n.effectScale,h=n.circleLeftRotation,y=n.circleRightRotation,g=n.circleClipPath,w=n.circleOpacity,x=h/360,b=function(n,e,t){return(1-n)*e+t}(x,c,s),S=Math.round((1-x)*c/b*100),E=Math.round(S/2),M=S+(100-S)/4;return{rules:{main:Se(S,f,p),effect:Ee(S,M,v,m),circleRight:Pe(E,y),circleLeft:Me(S,h),circle:(o=E,r=g,i=w,"\n  @keyframes circleIn {\n    0% {\n      clip-path: ".concat(r,";\n      opacity: ").concat(i,";\n    }\n    ").concat(o,"% {\n      clip-path: ").concat(r,";\n      opacity: 1;\n    }\n    ").concat(o+.01,"%, 100% {\n      clip-path: inset(0);\n      opacity: 1;\n    }\n  }\n"))},names:{main:(e=b,t=d,"".concat(e,"ms ease-out mainIn ").concat(t,"ms 1 normal forwards")),effect:ge(b,d),circleLeft:we(b,d),circleRight:xe(b,d),circle:be(b,d)}}}({time:r,extraTime:a,delay:l,currentColor:s.color||"currentcolor",targetColor:I.dataset.activeColor,effectOpacity:d.opacity||0,effectScale:d.scale||0,circleLeftRotation:f.rotate||0,circleRightRotation:p.rotate||0,circleClipPath:u.clipPath||"inset(0 0 0 50%)",circleOpacity:u.opacity||0}),e=n.rules,t=n.names;F=je(e.main),N=je(e.effect),V=je(e.circleLeft),H=je(e.circleRight),K=je(e.circle),I.style.animation=t.main,D.style.animation=t.effect,T.style.animation=t.circleLeft,O.style.animation=t.circleRight,R.style.animation=t.circle}}))},cn=function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{time:yn}).time,e=void 0===n?yn:n;if(k){k=!1;var t=getComputedStyle(I);I.style.color=t.color,I.style.animation="none";var o=getComputedStyle(R);R.style.clipPath=o.clipPath,R.style.opacity=o.opacity,R.style.animation="none";var r=tn(D);D.style.opacity=r.opacity,D.style.transform="scale(".concat(r.scale,")"),D.style.animation="none";var i="x"===o.clipPath.slice(-2,-1),a=tn(T,i);T.style.transform="rotate(".concat(a.rotate,"deg)"),T.style.animation="none";var c=tn(O);O.style.transform="rotate(".concat(c.rotate,"deg)"),O.style.animation="none",q().then((function(){null!==J&&ke(J),null!==$&&ke($),null!==U&&ke(U),null!==Y&&ke(Y),null!==X&&ke(X);var n=function(n){var e,t,o,r=n.time,i=void 0===r?yn:r,a=n.currentColor,c=n.targetColor,l=n.effectOpacity,s=n.effectScale,u=n.circleLeftRotation,d=n.circleRightRotation,f=n.circleClipPath,p=n.circleOpacity,v=u/360,m=v*i,h=Math.min(100,100*v),y=h>50?Math.round(100*(1-50/h)):0;return{rules:{main:Te(a,c),effect:(t=l,o=s,"\n  @keyframes effectOut {\n    0% {\n      opacity: ".concat(t,";\n      transform: scale(").concat(o,");\n    }\n    99% {\n      opacity: 0;\n      transform: scale(").concat(o+.5,");\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0);\n    }\n  }\n")),circleRight:Oe(y,d),circleLeft:De(u),circle:Le(y,f,p)},names:{main:(e=m,"".concat(e,"ms linear mainOut 0s 1 normal forwards")),effect:Ce(m),circleRight:Ae(m),circleLeft:Ie(m),circle:Re(m)}}}({time:e,currentColor:t.color||"currentcolor",targetColor:I.dataset.color,effectOpacity:r.opacity||0,effectScale:r.scale||0,circleLeftRotation:a.rotate||0,circleRightRotation:c.rotate||0,circleClipPath:o.clipPath||"inset(0px)",circleOpacity:o.opacity||1}),i=n.rules,l=n.names;X=je(i.main),Y=je(i.effect),U=je(i.circleLeft),$=je(i.circleRight),J=je(i.circle),I.style.animation=l.main,D.style.animation=l.effect,T.style.animation=l.circleLeft,O.style.animation=l.circleRight,R.style.animation=l.circle}))}},ln=function(){x(z,j)},sn=function(n){if(C){if((o=n[0],r=n[1],i=C[0],a=C[1],Math.sqrt((o-i)**2+(r-a)**2))>2){C=n;var e=E(n);z.push(e),j.push(e[0],e[1]),z.length>1&&ln()}}else{B||(B=!0,b()),C=n;var t=E(n);z=[t],j=[t[0],t[1]]}var o,r,i,a},un=G(sn,8,8),dn=function(n,t){var o=function(n){var t=e.getBoundingClientRect(),o=t.left,r=t.top;return[n.clientX-o,n.clientY-r]}(n);return t?un(o):sn(o)},fn=function(){z=[],j=[],C=void 0,ln()},pn=function(n){on(n)},gn=function(){L=!0,B=!0,fn(),b()},wn=function(){rn()},xn=function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).merge,e=void 0!==n&&n;B=!1;var t=s(z),o=s(j);return un.cancel(),fn(),t.length&&S(t,o,{merge:e}),t},bn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.onDraw,t=void 0===e?null:e,o=n.onStart,r=void 0===o?null:o,i=n.onEnd,a=void 0===i?null:i,c=n.enableInitiator,l=void 0===c?null:c,s=n.initiatorParentElement,u=void 0===s?null:s,d=n.longPressIndicatorParentElement,f=void 0===d?null:d;n.minDelay,n.minDist;var p=n.pointNorm,v=void 0===p?null:p;x=Be(t,x),b=Be(r,b),S=Be(a,S),y=Be(l,y),E=Be(v,E),null!==u&&u!==g&&(g.removeChild(M),u.appendChild(M),g=u),null!==f&&f!==w&&(w.removeChild(I),f.appendChild(I),w=f),y?(M.addEventListener("click",pn),M.addEventListener("mousedown",gn),M.addEventListener("mouseleave",wn)):(M.removeEventListener("mousedown",gn),M.removeEventListener("mouseleave",wn))},Sn=function(){g.removeChild(M),w.removeChild(I),window.removeEventListener("mouseup",Q),M.removeEventListener("click",pn),M.removeEventListener("mousedown",gn),M.removeEventListener("mouseleave",wn)};return g.appendChild(M),w.appendChild(I),bn({onDraw:x,onStart:b,onEnd:S,enableInitiator:y,initiatorParentElement:g}),((...n)=>e=>n.reduce(((n,e)=>e(n)),e))(Z("initiator",M),Z("longPressIndicator",I),(function(n){return W(n,{clear:fn,destroy:Sn,end:xn,extend:dn,set:bn,showInitiator:on,hideInitiator:rn,showLongPressIndicator:an,hideLongPressIndicator:cn})}),(nn=n,n=>W({__proto__:{constructor:nn}},n)))({})};const Ze=n=>`\nprecision highp float;\n\nuniform sampler2D colorTex;\nuniform float colorTexRes;\nuniform float colorTexEps;\nuniform sampler2D stateTex;\nuniform float stateTexRes;\nuniform float stateTexEps;\nuniform float devicePixelRatio;\nuniform sampler2D encodingTex;\nuniform float encodingTexRes;\nuniform float encodingTexEps;\nuniform float pointSizeExtra;\nuniform float pointOpacityMax;\nuniform float pointOpacityScale;\nuniform float numPoints;\nuniform float globalState;\nuniform float isColoredByZ;\nuniform float isColoredByW;\nuniform float isOpacityByZ;\nuniform float isOpacityByW;\nuniform float isOpacityByDensity;\nuniform float isSizedByZ;\nuniform float isSizedByW;\nuniform float colorMultiplicator;\nuniform float opacityMultiplicator;\nuniform float opacityDensity;\nuniform float sizeMultiplicator;\nuniform float numColorStates;\nuniform float pointScale;\nuniform mat4 modelViewProjection;\n\nattribute vec2 stateIndex;\n\nvarying vec4 color;\nvarying float finalPointSize;\n\nvoid main() {\n  vec4 state = texture2D(stateTex, stateIndex);\n\n  gl_Position = modelViewProjection * vec4(state.x, state.y, 0.0, 1.0);\n\n  // Determine color index\n  float colorIndexZ =  isColoredByZ * floor(state.z * colorMultiplicator);\n  float colorIndexW =  isColoredByW * floor(state.w * colorMultiplicator);\n\n  // Multiply by the number of color states per color\n  // I.e., normal, active, hover, background, etc.\n  float colorIndex = (colorIndexZ + colorIndexW) * numColorStates;\n\n  // Half a "pixel" or "texel" in texture coordinates\n  float colorLinearIndex = colorIndex + globalState;\n\n  // Need to add cEps here to avoid floating point issue that can lead to\n  // dramatic changes in which color is loaded as floor(3/2.9999) = 1 but\n  // floor(3/3.0001) = 0!\n  float colorRowIndex = floor((colorLinearIndex + colorTexEps) / colorTexRes);\n\n  vec2 colorTexIndex = vec2(\n    (colorLinearIndex / colorTexRes) - colorRowIndex + colorTexEps,\n    colorRowIndex / colorTexRes + colorTexEps\n  );\n\n  color = texture2D(colorTex, colorTexIndex);\n\n  // Retrieve point size\n  float pointSizeIndexZ = isSizedByZ * floor(state.z * sizeMultiplicator);\n  float pointSizeIndexW = isSizedByW * floor(state.w * sizeMultiplicator);\n  float pointSizeIndex = pointSizeIndexZ + pointSizeIndexW;\n\n  float pointSizeRowIndex = floor((pointSizeIndex + encodingTexEps) / encodingTexRes);\n  vec2 pointSizeTexIndex = vec2(\n    (pointSizeIndex / encodingTexRes) - pointSizeRowIndex + encodingTexEps,\n    pointSizeRowIndex / encodingTexRes + encodingTexEps\n  );\n  float pointSize = texture2D(encodingTex, pointSizeTexIndex).x;\n\n  // Retrieve opacity\n  ${3===n?"":`\n        if (isOpacityByDensity < 0.5) {\n          float opacityIndexZ = isOpacityByZ * floor(state.z * opacityMultiplicator);\n          float opacityIndexW = isOpacityByW * floor(state.w * opacityMultiplicator);\n          float opacityIndex = opacityIndexZ + opacityIndexW;\n\n          float opacityRowIndex = floor((opacityIndex + encodingTexEps) / encodingTexRes);\n          vec2 opacityTexIndex = vec2(\n            (opacityIndex / encodingTexRes) - opacityRowIndex + encodingTexEps,\n            opacityRowIndex / encodingTexRes + encodingTexEps\n          );\n          color.a = texture2D(encodingTex, opacityTexIndex)[${1+n}];\n        } else {\n          color.a = min(1.0, opacityDensity + globalState);\n        }\n      `}\n\n  color.a = min(pointOpacityMax, color.a) * pointOpacityScale;\n  finalPointSize = (pointSize * pointScale) + pointSizeExtra;\n  gl_PointSize = finalPointSize;\n}\n`;var qe=function(){var n=function(n,e,t,o,r){var i=.5*(o-e),a=.5*(r-t);return(2*t-2*o+i+a)*n*n*n+(-3*t+3*o-2*i-a)*n*n+i*n+t},e=function(e,t,o){var r=o*e,i=Math.floor(r),a=r-i,c=t[Math.max(0,i-1)],l=t[i],s=t[Math.min(o,i+1)],u=t[Math.min(o,i+2)];return[n(a,c[0],l[0],s[0],u[0]),n(a,c[1],l[1],s[1],u[1])]},t=function(n,e,t){var o=e[0],r=e[1],i=t[0]-o,a=t[1]-r;if(0!==i||0!==a){var c=((n[0]-o)*i+(n[1]-r)*a)/(i*i+a*a);c>1?(o=t[0],r=t[1]):c>0&&(o+=i*c,r+=a*c)}return(i=n[0]-o)*i+(a=n[1]-r)*a},o=function n(e,o,r,i,a){for(var c,l=i,s=o+1;s<r;s++){var u=t(e[s],e[o],e[r]);u>l&&(c=s,l=u)}l>i&&(c-o>1&&n(e,o,c,i,a),a.push(e[c]),r-c>1&&n(e,c,r,i,a))},r=function(n,e){var t=n.length-1,r=[n[0]];return o(n,0,t,e,r),r.push(n[t]),r};self.onmessage=function(n){(n.data.points?+n.data.points.length:0)||self.postMessage({error:new Error("No points provided")}),n.data.points;var t=function(n){var e={},t=!Number.isNaN(+n[0][5]);return n.forEach((function(n){var o=n[4];e[o]||(e[o]=[]),t?e[o][n[5]]=n:e[o].push(n)})),Object.entries(e).forEach((function(n){e[n[0]]=n[1].filter((function(n){return n})),e[n[0]].reference=n[1][0]})),e}(n.data.points);self.postMessage({points:Object.entries(t).reduce((function(t,o){return t[o[0]]=function(n){for(var t,o,i,a,c,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=l.maxIntPointsPerSegment,u=void 0===s?100:s,d=l.tolerance,f=void 0===d?.002:d,p=n.length,v=p-1,m=v*u+1,h=Math.pow(f,2),y=[],g=0;g<p-1;g++){var w=[n[g].slice(0,2)];t=n[g];for(var x=1;x<u;x++){var b=e((g*u+x)/m,n,v);o=t[0],i=t[1],a=b[0],c=b[1],Math.pow(o-a,2)+Math.pow(i-c,2)>h&&(w.push(b),t=b)}w.push(n[g+1]),w=r(w,h),y=y.concat(w.slice(0,w.length-1))}return y.push(n[n.length-1].slice(0,2)),y.flat()}(o[1],n.data.options),t[o[0]].reference=o[1].reference,t}),{})})}},Ge=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tolerance:.002,maxIntPointsPerSegment:100};return new Promise((function(t,o){var r,i=(r=qe,new Worker(window.URL.createObjectURL(new Blob([`(${r.toString()})()`],{type:"text/javascript"}))));i.onmessage=function(n){n.data.error?o(n.data.error):t(n.data.points),i.terminate()},i.postMessage({points:n,options:e})}))},He={showRecticle:"showReticle",recticleColor:"reticleColor"},Ke=function(n){Object.keys(n).filter((function(n){return He[n]})).forEach((function(e){console.warn('regl-scatterplot: the "'.concat(e,'" property is deprecated. Please use "').concat(He[e],'" instead.')),n[He[e]]=n[e],delete n[e]}))},Xe=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.allowSegment,r=void 0!==o&&o,i=t.allowDensity,a=void 0!==i&&i;return Kn.has(n)?"valueZ":Xn.has(n)?"valueW":"segment"===n?r?"segment":e:"density"===n&&a?"density":e},Ye=function(n){switch(n){case"valueZ":return 2;case"valueW":return 3;default:return null}};n.checkSupport=$n,n.createRegl=Jn,n.createRenderer=ye,n.createTextureFromUrl=re,n.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.default({async:!n.syncEvents,caseInsensitive:!0}),t=new Float32Array(16),o=new Float32Array(16),i=[0,0];Ke(n);var u=n.renderer,d=n.backgroundColor,f=void 0===d?Nn:d,p=n.backgroundImage,v=void 0===p?null:p,g=n.canvas,b=void 0===g?document.createElement("canvas"):g,S=n.colorBy,E=void 0===S?zn:S,P=n.deselectOnDblClick,C=void 0===P||P,A=n.deselectOnEscape,I=void 0===A||A,R=n.lassoColor,T=void 0===R?fn:R,O=n.lassoLineWidth,L=void 0===O?2:O,B=n.lassoMinDelay,z=void 0===B?10:B,j=n.lassoMinDist,k=void 0===j?3:j,N=n.lassoClearEvent,W=void 0===N?pn:N,Z=n.lassoInitiator,q=void 0!==Z&&Z,H=n.lassoInitiatorParentElement,K=void 0===H?document.body:H,U=n.lassoOnLongPress,$=void 0!==U&&U,$n=n.lassoLongPressTime,Jn=void 0===$n?vn:$n,ie=n.lassoLongPressAfterEffectTime,ae=void 0===ie?mn:ie,ce=n.lassoLongPressEffectDelay,se=void 0===ce?hn:ce,ue=n.lassoLongPressRevertEffectTime,ge=void 0===ue?yn:ue,we=n.keyMap,xe=void 0===we?In:we,be=n.mouseMode,Se=void 0===be?tn:be,Ee=n.showReticle,Me=void 0!==Ee&&Ee,Pe=n.reticleColor,Ce=void 0===Pe?Hn:Pe,Ae=n.pointColor,Ie=void 0===Ae?jn:Ae,Re=n.pointColorActive,Te=void 0===Re?kn:Re,Oe=n.pointColorHover,De=void 0===Oe?Fn:Oe,Le=n.showPointConnections,Be=void 0!==Le&&Le,ze=n.pointConnectionColor,je=void 0===ze?Vn:ze,ke=n.pointConnectionColorActive,Fe=void 0===ke?Wn:ke,Ne=n.pointConnectionColorHover,_e=void 0===Ne?Zn:Ne,Ve=n.pointConnectionColorBy,qe=void 0===Ve?_n:Ve,He=n.pointConnectionOpacity,Ue=void 0===He?null:He,$e=n.pointConnectionOpacityBy,Je=void 0===$e?Ln:$e,Qe=n.pointConnectionOpacityActive,nt=void 0===Qe?.66:Qe,et=n.pointConnectionSize,tt=void 0===et?2:et,ot=n.pointConnectionSizeActive,rt=void 0===ot?2:ot,it=n.pointConnectionSizeBy,at=void 0===it?Dn:it,ct=n.pointConnectionMaxIntPointsPerSegment,lt=void 0===ct?100:ct,st=n.pointConnectionTolerance,ut=void 0===st?.002:st,dt=n.pointSize,ft=void 0===dt?6:dt,pt=n.pointSizeSelected,vt=void 0===pt?2:pt,mt=n.pointSizeMouseDetection,ht=void 0===mt?"auto":mt,yt=n.pointOutlineWidth,gt=void 0===yt?2:yt,wt=n.opacity,xt=void 0===wt?X:wt,bt=n.opacityBy,St=void 0===bt?Bn:bt,Et=n.opacityByDensityFill,Mt=void 0===Et?.15:Et,Pt=n.opacityInactiveMax,Ct=void 0===Pt?1:Pt,At=n.opacityInactiveScale,It=void 0===At?1:At,Rt=n.sizeBy,Tt=void 0===Rt?On:Rt,Ot=n.height,Dt=void 0===Ot?Tn:Ot,Lt=n.width,Bt=void 0===Lt?Rn:Lt,zt=Bt===X?1:Bt,jt=Dt===X?1:Dt,kt=n.performanceMode,Ft=void 0!==kt&&kt,Nt=n.opacityByDensityDebounceTime,_t=void 0===Nt?25:Nt;u||(u=ye({regl:n.regl,gamma:n.gamma})),f=ve(f,!0),T=ve(T,!0),Ce=ve(Ce,!0);var Vt,Wt,Zt,qt,Gt,Ht,Kt,Xt,Yt,Ut,$t,Jt,Qt,no,eo,to,oo,ro=!1,io=he(f),ao=!1,co=null,lo=[0,0],so=-1,uo=[],fo=new Set,po=new Set,vo=!1,mo=new Set,ho=0,yo=0,go=!1,wo=[],xo=n.aspectRatio||1,bo=me(xe),So=!1,Eo=!0,Mo=!1;Ie=de(Ie)?s(Ie):[Ie],Te=de(Te)?s(Te):[Te],De=de(De)?s(De):[De],Ie=Ie.map((function(n){return ve(n,!0)})),Te=Te.map((function(n){return ve(n,!0)})),De=De.map((function(n){return ve(n,!0)})),xt=!Array.isArray(xt)&&Number.isNaN(+xt)?Ie[0][3]:xt,xt=ne(xt,ee,{minLength:1})?s(xt):[xt];var Po,Co,Ao,Io,Ro=1/(ft=ne(ft,ee,{minLength:1})?s(ft):[ft])[0];je="inherit"===je?s(Ie):(je=de(je)?s(je):[je]).map((function(n){return ve(n,!0)})),Fe="inherit"===Fe?s(Te):(Fe=de(Fe)?s(Fe):[Fe]).map((function(n){return ve(n,!0)})),_e="inherit"===_e?s(De):(_e=de(_e)?s(_e):[_e]).map((function(n){return ve(n,!0)})),Ue="inherit"===Ue?s(xt):ne(Ue,ee,{minLength:1})?s(Ue):[Ue],tt="inherit"===tt?s(ft):ne(tt,ee,{minLength:1})?s(tt):[tt],E=Xe(E,zn),St=Xe(St,Bn,{allowDensity:!0}),Tt=Xe(Tt,On),qe=Xe(qe,_n,{allowSegment:!0}),Je=Xe(Je,Ln,{allowSegment:!0}),at=Xe(at,Dn,{allowSegment:!0});var To,Oo,Do,Lo,Bo,zo,jo,ko,Fo,No,_o,Vo,Wo=0,Zo=0,qo=!1,Go=null,Ho=Me,Ko=0,Xo=0,Yo=!1,Uo=!1,$o=!1,Jo=cn,Qo=cn,nr=!1,er=n.xScale||null,tr=n.yScale||null,or=0,rr=0,ir=0,ar=0;er&&(or=er.domain()[0],rr=er.domain()[1]-er.domain()[0],er.range([0,zt])),tr&&(ir=tr.domain()[0],ar=tr.domain()[1]-tr.domain()[0],tr.range([jt,0]));var cr=function(n){return n/zt*2-1},lr=function(n){return 1+n/jt*-2},sr=function(n,e){var o=[n,e,1,1];return x(o,o,h(t,y(t,Gt,y(t,Vt.view,Kt)))),o.slice(0,2)},ur=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=si(),t=(eo[1]-to[1])/b.height;return(Qt*e+n)*t},dr=function(){return vo?Zt.points.filter((function(n,e){return mo.has(e)})):Zt.points},fr=function(n,e,t,o){var r=Zt.range(n,e,t,o);return vo?r.filter((function(n){return mo.has(n)})):r},pr=function(){var n=l([cr(i[0]),lr(i[1])],2),e=n[0],t=n[1],o=l(sr(e,t),2),r=o[0],a=o[1],c=ur(4),s=fr(r-c,a-c,r+c,a+c),u=c,d=-1;return s.forEach((function(n){var e=l(Zt.points[n],2),t=e[0],o=e[1],i=Qn(t,o,r,a);i<u&&(u=i,d=n)})),d},vr=function(n){var e,t,o,r,i,a=function(n){for(var e=1/0,t=-1/0,o=1/0,r=-1/0,i=0;i<n.length;i+=2)e=n[i]<e?n[i]:e,t=n[i]>t?n[i]:t,o=n[i+1]<o?n[i+1]:o,r=n[i+1]>r?n[i+1]:r;return[e,o,t,r]}(n);if(e=l(a,4),t=e[0],o=e[1],r=e[2],i=e[3],!(Number.isFinite(t)&&Number.isFinite(o)&&Number.isFinite(r)&&Number.isFinite(i)&&r-t>0&&i-o>0))return[];var c=fr.apply(void 0,s(a)),u=[];return c.forEach((function(e){(function(n){for(var e,t,o,r,i=l(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),a=i[0],c=i[1],s=!1,u=0,d=n.length-2;u<n.length;u+=2)e=n[u],t=n[u+1],o=n[d],t>c!=(r=n[d+1])>c&&a<(o-e)*(c-t)/(r-t)+e&&(s=!s),d=u;return s})(n,Zt.points[e])&&u.push(e)})),u},mr=function(){wo=[],Wt&&Wt.clear()},hr=function(n){return n&&n.length>4},yr=function(n,e){if(!Ut&&Be&&hr(Zt.points[n[0]])){var t=0===e,o=1===e?function(n){return po.add(n)}:_,r=Object.keys(n.reduce((function(n,e){var t=Zt.points[e];return n[Array.isArray(t[4])?t[4][0]:t[4]]=!0,n}),{})),i=Xt.getData().opacities;r.filter((function(n){return!po.has(+n)})).forEach((function(n){var e=Yt[n][0],r=Yt[n][2],a=4*e+2*Yt[n][3],c=a+2*r+4;void 0===i.__original__&&(i.__original__=i.slice());for(var l=a;l<c;l++)i[l]=t?i.__original__[l]:nt;o(n)})),Xt.getBuffer().opacities.subdata(i,0)}},gr=function(n){return[n%Wo/Wo+Zo,Math.floor(n/Wo)/Wo+Zo]},wr=function(n){return vo&&!mo.has(n)},xr=function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preventEvent,t=void 0!==n&&n;W===sn&&mr(),uo.length&&(t||e.publish("deselect"),po.clear(),yr(uo,0),uo=[],fo.clear(),Eo=!0)},br=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.merge,r=void 0!==o&&o,i=t.preventEvent,a=void 0!==i&&i,c=Array.isArray(n)?n:[n],l=s(uo);if(r){if(uo=((n,e)=>{const t=[];return n.forEach((n=>{t[n]=!0})),e.forEach((n=>{t[n]=!0})),t.reduce(((n,e,t)=>(e&&n.push(t),n)),[])})(uo,c),l.length===uo.length)return void(Eo=!0)}else{if(uo&&uo.length&&yr(uo,0),l.length>0&&0===c.length)return void xr({preventEvent:a});uo=c}if(((n,e)=>{if(n===e)return!0;if(n.length!==e.length)return!1;const t=new Set(n),o=new Set(e);return t.size===o.size&&e.every((n=>t.has(n)))})(l,uo))Eo=!0;else{var u=[];fo.clear(),po.clear();for(var d=uo.length-1;d>=0;d--){var f=uo[d];f<0||f>=ho||wr(f)?uo.splice(d,1):(fo.add(f),u.push.apply(u,gr(f)))}Oo({usage:"dynamic",type:"float",data:u}),yr(uo,1),a||e.publish("select",{points:uo}),Eo=!0}},Sr=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.showReticleOnce,r=void 0!==o&&o,i=t.preventEvent,a=void 0!==i&&i,c=!1;if(n>=0&&n<ho){c=!0;var l=Vo,s=n!==Vo;+l>=0&&s&&!fo.has(l)&&yr([l],0),Vo=n,Do.subdata(gr(n)),fo.has(n)||yr([n],2),s&&!a&&e.publish("pointover",Vo)}else(c=+Vo>=0)&&(fo.has(Vo)||yr([Vo],0),a||e.publish("pointout",Vo)),Vo=void 0;c&&(Eo=!0,Mo=r)},Er=function(n){var e=b.getBoundingClientRect();return i[0]=n.clientX-e.left,i[1]=n.clientY-e.top,[].concat(i)},Mr=We(b,{onStart:function(){Vt.config({isFixed:!0}),ao=!0,go=!0,mr(),so>=0&&(clearTimeout(so),so=-1),e.publish("lassoStart")},onDraw:function(n,t){wo=n,Wt.setPoints(t),e.publish("lassoExtend",{coordinates:n})},onEnd:function(n,t){var o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).merge,r=void 0!==o&&o;Vt.config({isFixed:!1}),wo=s(n);var i=vr(t);br(i,{merge:r}),e.publish("lassoEnd",{coordinates:wo}),W===un&&mr()},enableInitiator:q,initiatorParentElement:K,pointNorm:function(n){var e=l(n,2),t=e[0],o=e[1];return sr(cr(t),lr(o))}}),Pr=function(n,e){switch(bo[e]){case Sn:return n.altKey;case En:return n.metaKey;case Mn:return n.ctrlKey;case Pn:return n.metaKey;case Cn:return n.shiftKey;default:return!1}},Cr=function(n){Uo&&1===n.buttons&&(ao=!0,co=performance.now(),lo=Er(n),!(go=Se===Q||Pr(n,gn))&&$&&(Mr.showLongPressIndicator(n.clientX,n.clientY,{time:Jn,extraTime:ae,delay:se}),so=setTimeout((function(){so=-1,go=!0}),Jn)))},Ar=function(n){Uo&&(ao=!1,so>=0&&(clearTimeout(so),so=-1),go&&(n.preventDefault(),go=!1,Mr.end({merge:Pr(n,xn)})),$&&Mr.hideLongPressIndicator({time:ge}))},Ir=function(n){if(Uo){n.preventDefault();var e=Er(n);if(!(Qn.apply(void 0,s(e).concat(s(lo)))>=k)){var t=performance.now()-co;if(!q||t<500){var o=pr();o>=0?(uo.length&&W===sn&&mr(),br([o],{merge:Pr(n,xn)})):no||(no=setTimeout((function(){no=null,Mr.showInitiator(n)}),200))}}}},Rr=function(n){Mr.hideInitiator(),no&&(clearTimeout(no),no=null),C&&(n.preventDefault(),xr())},Tr=function(n){if($o||(nr=function(n){return document.elementsFromPoint(n.clientX,n.clientY).some((function(n){return n===b}))}(n),$o=!0),Uo&&(nr||ao)){var e=Er(n),t=Qn.apply(void 0,s(e).concat(s(lo)))>=k;nr&&!go&&Sr(pr()),go?(n.preventDefault(),Mr.extend(n,!0)):ao&&$&&t&&Mr.hideLongPressIndicator({time:ge}),so>=0&&t&&(clearTimeout(so),so=-1),ao&&(Eo=!0)}},Or=function(){Vo=void 0,nr=!1,$o=!1,Uo&&(+Vo>=0&&!fo.has(Vo)&&yr([Vo],0),Ar(),Eo=!0)},Dr=function(){var n=Math.max(ft.length,xt.length);Xo=Math.max(2,Math.ceil(Math.sqrt(n)));for(var e=new Float32Array(4*Math.pow(Xo,2)),t=0;t<n;t++){e[4*t]=ft[t]||0,e[4*t+1]=Math.min(1,xt[t]||0);var o=Number((Te[t]||Te[0])[3]);e[4*t+2]=Math.min(1,Number.isNaN(o)?1:o);var r=Number((De[t]||De[0])[3]);e[4*t+3]=Math.min(1,Number.isNaN(r)?1:r)}return u.regl.texture({data:e,shape:[Xo,Xo,4],type:"float"})},Lr=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Te,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De,o=n.length,r=e.length,i=t.length,a=[];if(o===r&&r===i)for(var c=0;c<o;c++)a.push(n[c],e[c],t[c],f);else for(var l=0;l<o;l++){var s=[n[l][0],n[l][1],n[l][2],1],u=E===zn?e[0]:s,d=E===zn?t[0]:s;a.push(n[l],u,d,f)}return a},Br=function(){var n=Lr(),e=n.length;Ko=Math.max(2,Math.ceil(Math.sqrt(e)));var t=new Float32Array(4*Math.pow(Ko,2));return n.forEach((function(n,e){t[4*e]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]})),u.regl.texture({data:t,shape:[Ko,Ko,4],type:"float"})},zr=function(){Gt=w([],[1/(qt=zt/jt),1,1]),Ht=w([],[1/qt,1,1]),Kt=w([],[xo,1,1])},jr=function(n,e){return function(t){if(t&&t.length){var o=s(n()),r=de(t)?t:[t];r=r.map((function(n){return ve(n,!0)})),No&&No.destroy();try{e(r),No=Br()}catch(n){console.error("Invalid colors. Switching back to default colors."),e(o),No=Br()}}}},kr=jr((function(){return Ie}),(function(n){Ie=n})),Fr=jr((function(){return Te}),(function(n){Te=n})),Nr=jr((function(){return De}),(function(n){De=n})),_r=function(){if(er||tr){var n,e,t,o,r,i,a=l((n=sr(-1,-1),e=sr(1,1),t=(n[0]+1)/2,o=(e[0]+1)/2,r=(n[1]+1)/2,i=(e[1]+1)/2,[[or+t*rr,or+o*rr],[ir+r*ar,ir+i*ar]]),2),c=a[0],s=a[1];er&&er.domain(c),tr&&tr.domain(s)}},Vr=function(n){jt=Math.max(1,n),b.height=Math.floor(jt*window.devicePixelRatio),tr&&(tr.range([jt,0]),_r())},Wr=function(){Qt=ht,ht===X&&(Qt=Array.isArray(ft)?ft.reduce(((n,e)=>e>n?e:n),-1/0):ft)},Zr=function(n){zt=Math.max(1,n),b.width=Math.floor(zt*window.devicePixelRatio),er&&(er.range([0,zt]),_r())},qr=function(n){switch(n){case"valueZ":return Jo;case"valueW":return Qo;default:return null}},Gr=function(n,e){return n===an?function(n){return Math.round(n*(e.length-1))}:_},Hr=function(){return[b.width,b.height]},Kr=function(){return No},Xr=function(){return Ko},Yr=function(){return.5/Ko},Ur=function(){return window.devicePixelRatio},$r=function(){return Oo},Jr=function(){return _o},Qr=function(){return Xo},ni=function(){return.5/Xo},ei=function(){return 0},ti=function(){return Ao||Po},oi=function(){return Wo},ri=function(){return.5/Wo},ii=function(){return Ht},ai=function(){return Vt.view},ci=function(){return Kt},li=function(){return y(o,Ht,y(o,Vt.view,Kt))},si=function(){return Vt.scaling[0]>1?Math.asinh(fe(1,Vt.scaling[0]))/Math.asinh(1)*window.devicePixelRatio:fe(Ro,Vt.scaling[0])*window.devicePixelRatio},ui=function(){return uo.length},di=function(){return ui()>0?Ct:1},fi=function(){return ui()>0?It:1},pi=function(){return+("valueZ"===E)},vi=function(){return+("valueW"===E)},mi=function(){return+("valueZ"===St)},hi=function(){return+("valueW"===St)},yi=function(){return+("density"===St)},gi=function(){return+("valueZ"===Tt)},wi=function(){return+("valueW"===Tt)},xi=function(){return"valueZ"===E?Jo===an?Ie.length-1:1:Qo===an?Ie.length-1:1},bi=function(){return"valueZ"===St?Jo===an?xt.length-1:1:Qo===an?xt.length-1:1},Si=function(){return"valueZ"===Tt?Jo===an?ft.length-1:1:Qo===an?ft.length-1:1},Ei=function(n){if("density"!==St)return 1;var e=si(),t=ft[0]*e,o=2/(2/Vt.view[0])*(2/(2/Vt.view[5])),r=n.viewportHeight,i=n.viewportWidth,a=Mt*i*r/(yo*t*t)*pe(1,o);a*=Ft?1:1/(.25*Math.PI);var c=fe(1,t)+.5;return a*=Math.pow(t/c,2),pe(1,fe(0,a))},Mi=u.regl({framebuffer:function(){return Io},vert:"precision highp float;\n\nattribute vec2 position;\nvarying vec2 particleTextureIndex;\n\nvoid main() {\n  // map normalized device coords to texture coords\n  particleTextureIndex = 0.5 * (1.0 + position);\n\n  gl_Position = vec4(position, 0, 1);\n}",frag:"precision highp float;\n\nuniform sampler2D startStateTex;\nuniform sampler2D endStateTex;\nuniform float t;\n\nvarying vec2 particleTextureIndex;\n\nvoid main() {\n  // Interpolate x, y, and value\n  vec3 start = texture2D(startStateTex, particleTextureIndex).xyw;\n  vec3 end = texture2D(endStateTex, particleTextureIndex).xyw;\n  vec3 curr = start * (1.0 - t) + end * t;\n\n  // The category cannot be interpolated\n  float endCategory = texture2D(endStateTex, particleTextureIndex).z;\n\n  gl_FragColor = vec4(curr.xy, endCategory, curr.z);\n}",attributes:{position:[-4,0,4,4,4,-4]},uniforms:{startStateTex:function(){return Co},endStateTex:function(){return Po},t:function(n,e){return e.t}},count:3}),Pi=function(n,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:di,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:fi;return u.regl({frag:Ft?"precision highp float;\n\nvarying vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n":"\nprecision highp float;\n\nvarying vec4 color;\nvarying float finalPointSize;\n\nfloat linearstep(float edge0, float edge1, float x) {\n  return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\nvoid main() {\n  vec2 c = gl_PointCoord * 2.0 - 1.0;\n  float sdf = length(c) * finalPointSize;\n  float alpha = linearstep(finalPointSize + 0.5, finalPointSize - 0.5, sdf);\n\n  gl_FragColor = vec4(color.rgb, alpha * color.a);\n}\n",vert:Ze(o),blend:{enable:!Ft,func:{srcRGB:"src alpha",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},depth:{enable:!1},attributes:{stateIndex:{buffer:t,size:2}},uniforms:{resolution:Hr,modelViewProjection:li,devicePixelRatio:Ur,pointScale:si,encodingTex:Jr,encodingTexRes:Qr,encodingTexEps:ni,pointOpacityMax:r,pointOpacityScale:i,pointSizeExtra:n,globalState:o,colorTex:Kr,colorTexRes:Xr,colorTexEps:Yr,stateTex:ti,stateTexRes:oi,stateTexEps:ri,isColoredByZ:pi,isColoredByW:vi,isOpacityByZ:mi,isOpacityByW:hi,isOpacityByDensity:yi,isSizedByZ:gi,isSizedByW:wi,colorMultiplicator:xi,opacityMultiplicator:bi,opacityDensity:Ei,sizeMultiplicator:Si,numColorStates:4},count:e,primitive:"points"})},Ci=Pi(ei,(function(){return vo?mo.size:ho}),(function(){return To})),Ai=Pi(ei,(function(){return 1}),(function(){return Do}),2,(function(){return 1}),(function(){return 1})),Ii=Pi((function(){return(vt+2*gt)*window.devicePixelRatio}),ui,$r,1,(function(){return 1}),(function(){return 1})),Ri=Pi((function(){return(vt+gt)*window.devicePixelRatio}),ui,$r,3,(function(){return 1}),(function(){return 1})),Ti=Pi((function(){return vt*window.devicePixelRatio}),ui,$r,1,(function(){return 1}),(function(){return 1})),Oi=u.regl({frag:"\nprecision mediump float;\n\nuniform sampler2D texture;\n\nvarying vec2 uv;\n\nvoid main () {\n  gl_FragColor = texture2D(texture, uv);\n}\n",vert:"\nprecision mediump float;\n\nuniform mat4 modelViewProjection;\n\nattribute vec2 position;\n\nvarying vec2 uv;\n\nvoid main () {\n  uv = position;\n  gl_Position = modelViewProjection * vec4(-1.0 + 2.0 * uv.x, 1.0 - 2.0 * uv.y, 0, 1);\n}\n",attributes:{position:[0,1,0,0,1,0,0,1,1,1,1,0]},uniforms:{modelViewProjection:li,texture:function(){return v}},count:6}),Di=u.regl({vert:"\n      precision mediump float;\n      uniform mat4 modelViewProjection;\n      attribute vec2 position;\n      void main () {\n        gl_Position = modelViewProjection * vec4(position, 0, 1);\n      }",frag:"\n      precision mediump float;\n      uniform vec4 color;\n      void main () {\n        gl_FragColor = vec4(color.rgb, 0.2);\n      }",depth:{enable:!1},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},attributes:{position:function(){return wo}},uniforms:{modelViewProjection:li,color:function(){return T}},elements:function(){return Array.from({length:wo.length-2},(function(n,e){return[0,e+1,e+2]}))}}),Li=function(n){for(var e=new Float32Array(2*n),t=0,o=0;o<n;++o){var r=gr(o);e[t]=r[0],e[t+1]=r[1],t+=2}return e},Bi=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.length;Wo=Math.max(2,Math.ceil(Math.sqrt(t))),Zo=.5/Wo;for(var o=new Float32Array(4*Math.pow(Wo,2)),r=!0,i=!0,a=0,c=0,l=0,s=0;s<t;++s)o[a=4*s]=n[s][0],o[a+1]=n[s][1],c=n[s][2]||0,l=n[s][3]||0,o[a+2]=c,o[a+3]=l,r&&(r=Number.isInteger(c)),i&&(i=Number.isInteger(l));return Jo=e.z&&ln.includes(e.z)?e.z:r?cn:an,Qo=e.w&&ln.includes(e.w)?e.w:i?cn:an,u.regl.texture({data:o,shape:[Wo,Wo,4],type:"float"})},zi=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Uo=!1,ho=n.length,yo=ho,Po&&Po.destroy(),Po=Bi(n,e),To({usage:"static",type:"float",data:Li(ho)}),Zt=new D(n,(function(n){return n[0]}),(function(n){return n[1]}),16),Uo=!0},ji=function(n,e){Lo=Vt.target,Bo=n,zo=Vt.distance[0],jo=e},ki=function(n){var e="inherit"===qe?E:qe;if("segment"===e){var t=je.length-1;return t<1?[]:n.reduce((function(n,e,o){for(var r=0,i=[],a=2;a<e.length;a+=2){var c=Math.sqrt(Math.pow(e[a-2]-e[a],2)+Math.pow(e[a-1]-e[a+1],2));i.push(c),r+=c}n[o]=[0];for(var l=0,s=0;s<e.length/2-1;s++)l+=i[s],n[o].push(4*Math.floor(l/r*t));return n}),[])}if(e){var o=Ye(e),r=Gr(qr(e),"inherit"===qe?Ie:je);return Yt.reduce((function(n,e){var t=l(e,2),i=t[0],a=t[1];return n[i]=4*r(a[o]),n}),[])}return Array(Yt.length).fill(0)},Fi=function(){var n="inherit"===Je?St:Je;if("segment"===n){var e=Ue.length-1;return e<1?[]:Yt.reduce((function(n,t){var o=l(t,3),r=o[0];o[1];var i=o[2];return n[r]=V(i,(function(n){return Ue[Math.floor(n/(i-1)*e)]})),n}),[])}if(n){var t=Ye(n),o="inherit"===Je?xt:Ue,r=Gr(qr(n),o);return Yt.reduce((function(n,e){var i=l(e,2),a=i[0],c=i[1];return n[a]=o[r(c[t])],n}),[])}},Ni=function(){var n="inherit"===at?Tt:at;if("segment"===n){var e=tt.length-1;return e<1?[]:Yt.reduce((function(n,t){var o=l(t,3),r=o[0];o[1];var i=o[2];return n[r]=V(i,(function(n){return tt[Math.floor(n/(i-1)*e)]})),n}),[])}if(n){var t=Ye(n),o="inherit"===at?ft:tt,r=Gr(qr(n),o);return Yt.reduce((function(n,e){var i=l(e,2),a=i[0],c=i[1];return n[a]=o[r(c[t])],n}),[])}},_i=function(n){return new Promise((function(e){Xt.setPoints([]),n&&n.length?(Ut=!0,Ge(n,{maxIntPointsPerSegment:lt,tolerance:ut}).then((function(n){!function(n){Yt=[];var e=0;Object.keys(n).forEach((function(t,o){Yt[t]=[o,n[t].reference,n[t].length/2,e],e+=n[t].length/2}))}(n);var t=Object.values(n);Xt.setPoints(1===t.length?t[0]:t,{colorIndices:ki(t),opacities:Fi(),widths:Ni()}),Ut=!1,e()}))):e()}))},Vi=function(n){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).preventEvent,o=void 0!==t&&t,r=Array.isArray(n)?n:[n];vo=!0,mo.clear();for(var i=[],a=[],c=r.length-1;c>=0;c--){var l=r[c];l<0||l>=ho?r.splice(c,1):(mo.add(l),i.push.apply(i,gr(l)),fo.has(l)&&a.push(l))}return To.subdata(i),br(a,{preventEvent:o}),mo.has(Vo)||Sr(-1,{preventEvent:o}),new Promise((function(n){var t=function(){e.subscribe("draw",(function(){o||e.publish("filter",{points:r}),n()}),1),Eo=!0};Be||hr(Zt.points[0])?_i(dr()).then((function(){o||e.publish("pointConnectionsDraw"),br(a,{preventEvent:o}),t()})):t()}))},Wi=function(){return fr(to[0],to[1],eo[0],eo[1])},Zi=G((function(){yo=Wi().length}),_t),qi=function(){return Boolean(Co&&Ao)},Gi=function(){return Boolean(void 0!==Lo&&void 0!==Bo&&void 0!==zo&&void 0!==jo)},Hi=function(n,e){Go||(Go=performance.now());var t,o,r,i=performance.now()-Go,a=(t=e(i/n),o=0,r=1,Math.min(r,Math.max(o,t)));return qi()&&Mi({t:a}),Gi()&&function(n){var e=l(Lo,2),t=e[0],o=e[1],r=l(Bo,2),i=1-n,a=t*i+r[0]*n,c=o*i+r[1]*n,s=zo*i+jo*n;Vt.lookAt([a,c],s)}(a),i<n},Ki=function(){qo=!1,Go=null,ko=void 0,Fo=void 0,Me=Ho,Co&&(Co.destroy(),Co=void 0),Ao&&(Ao.destroy(),Ao=void 0),Lo=void 0,Bo=void 0,zo=void 0,jo=void 0,e.publish("transitionEnd")},Xi=function(n){var t=n.duration,o=void 0===t?500:t,r=n.easing,i=void 0===r?rn:r;qo&&e.publish("transitionEnd"),qo=!0,Go=null,ko=o,Fo=le(i)?on[i]||rn:i,Ho=Me,Me=!1,e.publish("transitionStart")},Yi=function(n){return function(){var e=n.apply(void 0,arguments);return Eo=!0,e}},Ui=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o){var r=[n.x+n.width/2,n.y+n.height/2],i=2*Math.atan(1),a=n.height*qt>n.width?n.height/2/Math.tan(i/2):n.width/2/Math.tan(i*qt/2);t.transition?(Vt.config({isFixed:!0}),ji(r,a),e.subscribe("transitionEnd",(function(){o(),Vt.config({isFixed:!1})}),1),Xi({duration:t.transitionDuration,easing:t.transitionEasing})):(Vt.lookAt(r,a),e.subscribe("draw",o,1),Eo=!0)}))},$i=function(n,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r){o.transition?(Vt.config({isFixed:!0}),ji(n,t),e.subscribe("transitionEnd",(function(){r(),Vt.config({isFixed:!1})}),1),Xi({duration:o.transitionDuration,easing:o.transitionEasing})):(Vt.lookAt(n,t),e.subscribe("draw",r,1),Eo=!0)}))},Ji=function(){Xt.setStyle({color:Lr(je,Fe,_e),opacity:null===Ue?null:Ue[0],width:tt[0]})},Qi=function(){var n=Math.round(io)>.5?0:255;Mr.initiator.style.border="1px dashed rgba(".concat(n,", ").concat(n,", ").concat(n,", 0.33)"),Mr.initiator.style.background="rgba(".concat(n,", ").concat(n,", ").concat(n,", 0.1)")},na=function(){var n=Math.round(io)>.5?0:255;Mr.longPressIndicator.style.color="rgb(".concat(n,", ").concat(n,", ").concat(n,")"),Mr.longPressIndicator.dataset.color="rgb(".concat(n,", ").concat(n,", ").concat(n,")");var e=T.map((function(n){return Math.round(255*n)}));Mr.longPressIndicator.dataset.activeColor="rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")")},ea=function(n){n&&Vt.setView(n)},ta=function(n,e){return function(t){if("inherit"===t)n(s(e()));else{var o=de(t)?t:[t];n(o.map((function(n){return ve(n,!0)})))}Ji()}},oa=ta((function(n){je=n}),(function(){return Ie})),ra=ta((function(n){Fe=n}),(function(){return Te})),ia=ta((function(n){_e=n}),(function(){return De})),aa=function(){var n,t,o,r,i,a,c,d,p,m,h,y,g,w,x,S,M,P,A,R,O,D,B,j,F,N,_,V,Z,G,H,Y,U,Q,tn,on,rn,an,cn,ln=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ke(ln),void 0===ln.backgroundColor&&void 0===ln.background||(n=ln.backgroundColor||ln.background)&&(f=ve(n,!0),io=he(f),Qi(),na()),void 0!==ln.backgroundImage&&((t=ln.backgroundImage)?le(t)?re(u.regl,t).then((function(n){v=n,Eo=!0,e.publish("backgroundImageReady")})).catch((function(){console.error("Count not create texture from ".concat(t)),v=null})):v="texture2d"===t._reglType?t:null:v=null),void 0!==ln.cameraTarget&&(o=ln.cameraTarget)&&Vt.lookAt(o,Vt.distance[0],Vt.rotation),void 0!==ln.cameraDistance&&(r=ln.cameraDistance)>0&&Vt.lookAt(Vt.target,r,Vt.rotation),void 0!==ln.cameraRotation&&null!==(i=ln.cameraRotation)&&Vt.lookAt(Vt.target,Vt.distance[0],i),void 0!==ln.cameraView&&ea(ln.cameraView),void 0!==ln.colorBy&&(a=ln.colorBy,E=Xe(a,zn)),void 0!==ln.pointColor&&kr(ln.pointColor),void 0!==ln.pointColorActive&&Fr(ln.pointColorActive),void 0!==ln.pointColorHover&&Nr(ln.pointColorHover),void 0!==ln.pointSize&&(c=ln.pointSize,ne(c,ee,{minLength:1})&&(ft=s(c)),te(+c)&&(ft=[+c]),Ro=1/ft[0],_o=Dr(),Wr()),void 0!==ln.pointSizeSelected&&(!+(d=ln.pointSizeSelected)||+d<0||(vt=+d)),void 0!==ln.pointSizeMouseDetection&&(p=ln.pointSizeMouseDetection,ht=p,Wr()),void 0!==ln.sizeBy&&function(n){Tt=Xe(n,On)}(ln.sizeBy),void 0!==ln.opacity&&(m=ln.opacity,ne(m,ee,{minLength:1})&&(xt=s(m)),te(+m)&&(xt=[+m]),_o=Dr()),void 0!==ln.showPointConnections&&(h=ln.showPointConnections,(Be=!!h)?hr(Zt.points[0])&&_i(dr()).then((function(){e.publish("pointConnectionsDraw"),Eo=!0})):_i()),void 0!==ln.pointConnectionColor&&oa(ln.pointConnectionColor),void 0!==ln.pointConnectionColorActive&&ra(ln.pointConnectionColorActive),void 0!==ln.pointConnectionColorHover&&ia(ln.pointConnectionColorHover),void 0!==ln.pointConnectionColorBy&&function(n){qe=Xe(n,_n,{allowSegment:!0})}(ln.pointConnectionColorBy),void 0!==ln.pointConnectionOpacityBy&&function(n){Je=Xe(n,Ln,{allowSegment:!0})}(ln.pointConnectionOpacityBy),void 0!==ln.pointConnectionOpacity&&function(n){ne(n,ee,{minLength:1})&&(Ue=s(n)),te(+n)&&(Ue=[+n]),je=je.map((function(n){return n[3]=Number.isNaN(+Ue[0])?n[3]:+Ue[0],n})),Ji()}(ln.pointConnectionOpacity),void 0!==ln.pointConnectionOpacityActive&&function(n){!Number.isNaN(+n)&&+n&&(nt=+n)}(ln.pointConnectionOpacityActive),void 0!==ln.pointConnectionSize&&(y=ln.pointConnectionSize,ne(y,ee,{minLength:1})&&(tt=s(y)),te(+y)&&(tt=[+y]),Ji()),void 0!==ln.pointConnectionSizeActive&&(g=ln.pointConnectionSizeActive,!Number.isNaN(+g)&&+g&&(rt=Math.max(0,g))),void 0!==ln.pointConnectionSizeBy&&function(n){at=Xe(n,Dn,{allowSegment:!0})}(ln.pointConnectionSizeBy),void 0!==ln.pointConnectionMaxIntPointsPerSegment&&(w=ln.pointConnectionMaxIntPointsPerSegment,lt=Math.max(0,w)),void 0!==ln.pointConnectionTolerance&&(x=ln.pointConnectionTolerance,ut=Math.max(0,x)),void 0!==ln.opacityBy&&function(n){St=Xe(n,Bn,{allowDensity:!0})}(ln.opacityBy),void 0!==ln.lassoColor&&function(n){if(n){T=ve(n,!0),Wt.setStyle({color:T});var e=T.map((function(n){return Math.round(255*n)}));Mr.longPressIndicator.dataset.activeColor="rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")")}}(ln.lassoColor),void 0!==ln.lassoLineWidth&&(S=ln.lassoLineWidth,Number.isNaN(+S)||+S<1||(L=+S,Wt.setStyle({width:L}))),void 0!==ln.lassoMinDelay&&+(M=ln.lassoMinDelay)&&(z=+M,Mr.set({minDelay:z})),void 0!==ln.lassoMinDist&&+(P=ln.lassoMinDist)&&(k=+P,Mr.set({minDist:k})),void 0!==ln.lassoClearEvent&&(A=ln.lassoClearEvent,W=oe(dn,W)(A)),void 0!==ln.lassoInitiator&&(R=ln.lassoInitiator,q=Boolean(R),Mr.set({enableInitiator:q})),void 0!==ln.lassoInitiatorParentElement&&(O=ln.lassoInitiatorParentElement,K=O,Mr.set({startInitiatorParentElement:K})),void 0!==ln.lassoOnLongPress&&(D=ln.lassoOnLongPress,$=Boolean(D)),void 0!==ln.lassoLongPressTime&&(B=ln.lassoLongPressTime,Jn=Number(B)),void 0!==ln.lassoLongPressAfterEffectTime&&(j=ln.lassoLongPressAfterEffectTime,ae=Number(j)),void 0!==ln.lassoLongPressEffectDelay&&(F=ln.lassoLongPressEffectDelay,se=Number(F)),void 0!==ln.lassoLongPressRevertEffectTime&&function(n){ge=Number(n)}(ln.lassoLongPressRevertEffectTime),void 0!==ln.keyMap&&(N=ln.keyMap,xe=Object.entries(N).reduce((function(n,e){var t=l(e,2),o=t[0],r=t[1];return An.includes(o)&&bn.includes(r)&&(n[o]=r),n}),{}),(bo=me(xe))[wn]?Vt.config({isRotate:!0,mouseDownMoveModKey:bo[wn]}):Vt.config({isRotate:!1})),void 0!==ln.mouseMode&&(_=ln.mouseMode,Se=oe(en,J)(_),Vt.config({defaultMouseDownMoveAction:Se===nn?"rotate":"pan"})),void 0!==ln.showReticle&&null!==(V=ln.showReticle)&&(Me=V),void 0!==ln.reticleColor&&(Z=ln.reticleColor)&&(Ce=ve(Z,!0),$t.setStyle({color:Ce}),Jt.setStyle({color:Ce})),void 0!==ln.pointOutlineWidth&&(!+(G=ln.pointOutlineWidth)||+G<0||(gt=+G)),void 0!==ln.height&&function(n){if(n===X)return Dt=n,b.style.height="100%",void window.requestAnimationFrame((function(){b&&Vr(b.getBoundingClientRect().height)}));!+n||+n<=0||(Vr(Dt=+n),b.style.height="".concat(Dt,"px"))}(ln.height),void 0!==ln.width&&function(n){if(n===X)return Bt=n,b.style.width="100%",void window.requestAnimationFrame((function(){b&&Zr(b.getBoundingClientRect().width)}));!+n||+n<=0||(Zr(Bt=+n),b.style.width="".concat(zt,"px"))}(ln.width),void 0!==ln.aspectRatio&&(+(H=ln.aspectRatio)<=0||(xo=H)),void 0!==ln.xScale&&(Y=ln.xScale)&&(er=Y,or=Y.domain()[0],rr=Y?Y.domain()[1]-Y.domain()[0]:0,er.range([0,zt]),_r()),void 0!==ln.yScale&&(U=ln.yScale)&&(ir=(tr=U).domain()[0],ar=tr?tr.domain()[1]-tr.domain()[0]:0,tr.range([jt,0]),_r()),void 0!==ln.deselectOnDblClick&&(Q=ln.deselectOnDblClick,C=!!Q),void 0!==ln.deselectOnEscape&&(tn=ln.deselectOnEscape,I=!!tn),void 0!==ln.opacityByDensityFill&&(on=ln.opacityByDensityFill,Mt=+on),void 0!==ln.opacityInactiveMax&&(rn=ln.opacityInactiveMax,Ct=+rn),void 0!==ln.opacityInactiveScale&&(an=ln.opacityInactiveScale,It=+an),void 0!==ln.gamma&&(cn=ln.gamma,u.gamma=cn),new Promise((function(n){window.requestAnimationFrame((function(){b&&(zr(),Vt.refresh(),u.refresh(),Eo=!0,n())}))}))},ca=function(){Vt||(Vt=M(b,{isPanInverted:[!1,!0]})),n.cameraView?Vt.setView(m(n.cameraView)):n.cameraTarget||n.cameraDistance||n.cameraRotation?Vt.lookAt(s(n.cameraTarget||qn),n.cameraDistance||1,n.cameraRotation||0):Vt.setView(m(Gn)),eo=sr(1,1),to=sr(-1,-1)},la=function(n){if("Escape"===n.key)I&&xr()},sa=function(){nr=!0,$o=!0},ua=function(){Sr(),nr=!1,$o=!0,Eo=!0},da=function(){Eo=!0},fa=function(){Vt.refresh();var n=Bt===X,e=Dt===X;if(n||e){var t=b.getBoundingClientRect(),o=t.width,r=t.height;n&&Zr(o),e&&Vr(r),zr(),Eo=!0}},pa=u.onFrame((function(){Yo=Vt.tick(),Uo&&(Eo||qo)&&(qo&&!Hi(ko,Fo)&&Ki(),Yo&&(eo=sr(1,1),to=sr(-1,-1),"density"===St&&Zi()),u.render((function(){!function(n,e){Ht[0]=n/qt,Ht[5]=e}(b.width/u.canvas.width,b.height/u.canvas.height),v&&v._reglType&&Oi(),wo.length>2&&Di(),qo||Xt.draw({projection:ii(),model:ci(),view:ai()}),Ci(),ao||!Me&&!Mo||function(){if(Vo>=0){var n=l(Zt.points[Vo].slice(0,2),2),e=[n[0],n[1],0,1];y(t,Ht,y(t,Vt.view,Kt)),x(e,e,t),$t.setPoints([-1,e[1],1,e[1]]),Jt.setPoints([e[0],1,e[0],-1]),$t.draw(),Jt.draw(),Pi((function(){return(vt+2*gt)*window.devicePixelRatio}),(function(){return 1}),Do,1)(),Pi((function(){return(vt+gt)*window.devicePixelRatio}),(function(){return 1}),Do,3)()}}(),Vo>=0&&Ai(),uo.length&&(Ii(),Ri(),Ti()),Wt.draw({projection:ii(),model:ci(),view:ai()})}),b),Yo&&(_r(),So?So=!1:e.publish("view",{view:Vt.view,camera:Vt,xScale:er,yScale:tr})),Eo=!1,Mo=!1,e.publish("draw"))}));return function(){zr(),ca(),_r(),Wt=F(u.regl,{color:T,width:L,is2d:!0}),Xt=F(u.regl,{color:je,colorHover:_e,colorActive:Fe,opacity:null===Ue?null:Ue[0],width:tt[0],widthActive:rt,is2d:!0}),$t=F(u.regl,{color:Ce,width:1,is2d:!0}),Jt=F(u.regl,{color:Ce,width:1,is2d:!0}),Wr(),b.addEventListener("wheel",da),To=u.regl.buffer(),Oo=u.regl.buffer(),Do=u.regl.buffer({usage:"dynamic",type:"float",length:2*Y}),No=Br(),_o=Dr();var n=aa({backgroundImage:v,width:Bt,height:Dt,keyMap:xe});Qi(),na(),window.addEventListener("keyup",la,!1),window.addEventListener("blur",Or,!1),window.addEventListener("mouseup",Ar,!1),window.addEventListener("mousemove",Tr,!1),b.addEventListener("mousedown",Cr,!1),b.addEventListener("mouseenter",sa,!1),b.addEventListener("mouseleave",ua,!1),b.addEventListener("click",Ir,!1),b.addEventListener("dblclick",Rr,!1),"ResizeObserver"in window?(oo=new ResizeObserver(fa)).observe(b):(window.addEventListener("resize",fa),window.addEventListener("orientationchange",fa)),n.then((function(){e.publish("init")}))}(),{get isSupported(){return u.isSupported},clear:Yi((function(){zi([]),Xt.clear()})),createTextureFromUrl:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yn;return re(u.regl,n,e)},deselect:xr,destroy:function(){Uo=!1,ro=!0,pa(),window.removeEventListener("keyup",la,!1),window.removeEventListener("blur",Or,!1),window.removeEventListener("mouseup",Ar,!1),window.removeEventListener("mousemove",Tr,!1),b.removeEventListener("mousedown",Cr,!1),b.removeEventListener("mouseenter",sa,!1),b.removeEventListener("mouseleave",ua,!1),b.removeEventListener("click",Ir,!1),b.removeEventListener("dblclick",Rr,!1),b.removeEventListener("wheel",da,!1),oo?oo.disconnect():(window.removeEventListener("resize",fa),window.removeEventListener("orientationchange",fa)),b=void 0,Vt.dispose(),Vt=void 0,Wt.destroy(),Mr.destroy(),Xt.destroy(),$t.destroy(),Jt.destroy(),n.renderer||u.destroy(),e.publish("destroy"),e.clear()},draw:function(n){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ro?Promise.reject(new Error("The instance was already destroyed")):(t=n,new Promise((function(n,e){if(!t||Array.isArray(t))n(t);else{var o=Array.isArray(t.x)||ArrayBuffer.isView(t.x)?t.x.length:0,r=(Array.isArray(t.x)||ArrayBuffer.isView(t.x))&&function(n){return t.x[n]},i=(Array.isArray(t.y)||ArrayBuffer.isView(t.y))&&function(n){return t.y[n]},a=(Array.isArray(t.line)||ArrayBuffer.isView(t.line))&&function(n){return t.line[n]},c=(Array.isArray(t.lineOrder)||ArrayBuffer.isView(t.lineOrder))&&function(n){return t.lineOrder[n]},l=Object.keys(t),s=(f=l.find((function(n){return Kn.has(n)})))&&(Array.isArray(t[f])||ArrayBuffer.isView(t[f]))&&function(n){return t[f][n]},u=(d=l.find((function(n){return Xn.has(n)})))&&(Array.isArray(t[d])||ArrayBuffer.isView(t[d]))&&function(n){return t[d][n]};r&&i&&s&&u&&a&&c?n(t.x.map((function(n,e){return[n,i(e),s(e),u(e),a(e),c(e)]}))):r&&i&&s&&u&&a?n(Array.from({length:o},(function(n,e){return[r(e),i(e),s(e),u(e),a(e)]}))):r&&i&&s&&u?n(Array.from({length:o},(function(n,e){return[r(e),i(e),s(e),u(e)]}))):r&&i&&s?n(Array.from({length:o},(function(n,e){return[r(e),i(e),s(e)]}))):r&&i?n(Array.from({length:o},(function(n,e){return[r(e),i(e)]}))):e(new Error("You need to specify at least x and y"))}var d,f}))).then((function(n){return new Promise((function(t){if(ro)t();else{var r=!1;o.preventFilterReset&&(null==n?void 0:n.length)===ho||(vo=!1,mo.clear());var i=n&&hr(n[0])&&(Be||o.showPointConnectionsOnce),a=o.zDataType,c=o.wDataType;n&&(o.transition&&(n.length===ho?r=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Po)return!1;if(qo){var t=Co;Co=Ao,t.destroy()}else Co=Po;return Ao=Bi(n,e),Io=u.regl.framebuffer({color:Ao,depth:!1,stencil:!1}),Po=void 0,!0}(n,{z:a,w:c}):console.warn("Cannot transition! The number of points between the previous and current draw call must be identical.")),zi(n,{z:a,w:c}),void 0!==o.hover&&Sr(o.hover,{preventEvent:!0}),void 0!==o.select&&br(o.select,{preventEvent:!0}),void 0!==o.filter&&Vi(o.filter,{preventEvent:!0}),i&&_i(n).then((function(){e.publish("pointConnectionsDraw"),Eo=!0,Mo=o.showReticleOnce}))),o.transition&&r?(i?Promise.all([new Promise((function(n){e.subscribe("transitionEnd",(function(){Eo=!0,Mo=o.showReticleOnce,n()}),1)})),new Promise((function(n){e.subscribe("pointConnectionsDraw",n,1)}))]).then(t):e.subscribe("transitionEnd",(function(){Eo=!0,Mo=o.showReticleOnce,t()}),1),Xi({duration:o.transitionDuration,easing:o.transitionEasing})):(i?Promise.all([new Promise((function(n){e.subscribe("draw",n,1)})),new Promise((function(n){e.subscribe("pointConnectionsDraw",n,1)}))]).then(t):e.subscribe("draw",t,1),Eo=!0,Mo=o.showReticleOnce)}}))}))},filter:Vi,get:function(n){return Ke({property:!0}),"aspectRatio"===n?xo:"background"===n||"backgroundColor"===n?f:"backgroundImage"===n?v:"camera"===n?Vt:"cameraTarget"===n?Vt.target:"cameraDistance"===n?Vt.distance[0]:"cameraRotation"===n?Vt.rotation:"cameraView"===n?Vt.view:"canvas"===n?b:"colorBy"===n?E:"sizeBy"===n?Tt:"deselectOnDblClick"===n?C:"deselectOnEscape"===n?I:"height"===n?Dt:"lassoColor"===n?T:"lassoLineWidth"===n?L:"lassoMinDelay"===n?z:"lassoMinDist"===n?k:"lassoClearEvent"===n?W:"lassoInitiator"===n?q:"lassoInitiatorElement"===n?Mr.initiator:"lassoInitiatorParentElement"===n?K:"keyMap"===n?function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?a(Object(t),!0).forEach((function(e){c(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}({},xe):"mouseMode"===n?Se:"opacity"===n?1===xt.length?xt[0]:xt:"opacityBy"===n?St:"opacityByDensityFill"===n?Mt:"opacityByDensityDebounceTime"===n?_t:"opacityInactiveMax"===n?Ct:"opacityInactiveScale"===n?It:"points"===n?Zt.points:"hoveredPoint"===n?Vo:"selectedPoints"===n?s(uo):"filteredPoints"===n?vo?Array.from(mo):Array.from({length:Zt.points.length},(function(n,e){return e})):"pointsInView"===n?Wi():"pointColor"===n?1===Ie.length?Ie[0]:Ie:"pointColorActive"===n?1===Te.length?Te[0]:Te:"pointColorHover"===n?1===De.length?De[0]:De:"pointOutlineWidth"===n?gt:"pointSize"===n?1===ft.length?ft[0]:ft:"pointSizeSelected"===n?vt:"pointSizeMouseDetection"===n?ht:"showPointConnections"===n?Be:"pointConnectionColor"===n?1===je.length?je[0]:je:"pointConnectionColorActive"===n?1===Fe.length?Fe[0]:Fe:"pointConnectionColorHover"===n?1===_e.length?_e[0]:_e:"pointConnectionColorBy"===n?qe:"pointConnectionOpacity"===n?1===Ue.length?Ue[0]:Ue:"pointConnectionOpacityBy"===n?Je:"pointConnectionOpacityActive"===n?nt:"pointConnectionSize"===n?1===tt.length?tt[0]:tt:"pointConnectionSizeActive"===n?rt:"pointConnectionSizeBy"===n?at:"pointConnectionMaxIntPointsPerSegment"===n?lt:"pointConnectionTolerance"===n?ut:"reticleColor"===n?Ce:"regl"===n?u.regl:"showReticle"===n?Me:"version"===n?"1.8.4":"width"===n?Bt:"xScale"===n?er:"yScale"===n?tr:"performanceMode"===n?Ft:"gamma"===n?u.gamma:"renderer"===n?u:"isDestroyed"===n?ro:"isPointsDrawn"===n?Uo:"isPointsFiltered"===n?vo:"zDataType"===n?Jo:"wDataType"===n?Qo:void 0},getScreenPosition:function(n){if(!Uo)throw new Error(Un);var e=Zt.points[n];if(e){var o=[e[0],e[1],0,1];return y(t,Gt,y(t,Vt.view,Kt)),x(o,o,t),[zt*(o[0]+1)/2,jt*(.5-o[1]/2)]}},hover:Sr,redraw:function(){Eo=!0},refresh:u.refresh,reset:Yi((function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preventEvent,t=void 0!==n&&n;ca(),_r(),t||e.publish("view",{view:Vt.view,camera:Vt,xScale:er,yScale:tr})})),select:br,set:aa,export:function(){return b.getContext("2d").getImageData(0,0,b.width,b.height)},subscribe:e.subscribe,unfilter:function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preventEvent,t=void 0!==n&&n;return vo=!1,mo.clear(),To.subdata(Li(ho)),new Promise((function(n){var o=function(){e.subscribe("draw",(function(){t||e.publish("unfilter"),n()}),1),Eo=!0};Be||hr(Zt.points[0])?_i(dr()).then((function(){t||e.publish("pointConnectionsDraw"),o()})):o()}))},unsubscribe:e.unsubscribe,view:function(n){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).preventEvent,t=void 0!==e&&e;ea(n),Eo=!0,So=t},zoomToLocation:$i,zoomToArea:Ui,zoomToPoints:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Uo)return Promise.reject(new Error(Un));var t=function(n){for(var e=1/0,t=-1/0,o=1/0,r=-1/0,i=0;i<n.length;i++){var a=l(Zt.points[n[i]],2),c=a[0],s=a[1];e=Math.min(e,c),t=Math.max(t,c),o=Math.min(o,s),r=Math.max(r,s)}return{x:e,y:o,width:t-e,height:r-o}}(n),o=t.x+t.width/2,r=t.y+t.height/2,i=ur(),a=1+(e.padding||0),c=Math.max(t.width,i)*a,s=Math.max(t.height,i)*a;return Ui({x:o-c/2,y:r-s/2,width:c,height:s},e)},zoomToOrigin:function(){return $i([0,0],1,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}}},Object.defineProperty(n,"__esModule",{value:!0})}));
